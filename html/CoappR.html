<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>CoappR</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library CoappR</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.funind.Recdef.html#"><span class="id" type="library">Recdef</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.NArith.NArith.html#"><span class="id" type="library">NArith</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Sorting.html#"><span class="id" type="library">Sorting</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="sets.html#"><span class="id" type="library">sets</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Permutations.html#"><span class="id" type="library">Permutations</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="general_tactics.html#"><span class="id" type="library">general_tactics</span></a>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="SSWP"><span class="id" type="module">SSWP</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.MSets.MSetProperties.html#WPropertiesOn"><span class="id" type="module">WPropertiesOn</span></a> <a class="idref" href="sets.html#SetOfSetsOfPositiveOrderedType"><span class="id" type="module">SetOfSetsOfPositiveOrderedType</span></a> <a class="idref" href="sets.html#SS"><span class="id" type="module">SS</span></a>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="SSWEqP"><span class="id" type="module">SSWEqP</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.MSets.MSetEqProperties.html#WEqPropertiesOn"><span class="id" type="module">WEqPropertiesOn</span></a> <a class="idref" href="sets.html#SetOfSetsOfPositiveOrderedType"><span class="id" type="module">SetOfSetsOfPositiveOrderedType</span></a> <a class="idref" href="sets.html#SS"><span class="id" type="module">SS</span></a>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="STWEqP"><span class="id" type="module">STWEqP</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.MSets.MSetEqProperties.html#WEqPropertiesOn"><span class="id" type="module">WEqPropertiesOn</span></a> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType"><span class="id" type="module">SetOfTuplesOfPositiveOrderedType</span></a> <a class="idref" href="sets.html#ST"><span class="id" type="module">ST</span></a>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="keyword">Import</span> <a name="PosSort"><span class="id" type="module">PosSort</span></a> := <span class="id" type="keyword">Sort</span> <a class="idref" href="sets.html#PosOrder"><span class="id" type="module">PosOrder</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>).<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">IHm</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>))<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="have_tuple_suitable_points_auxCPbis"><span class="id" type="definition">have_tuple_suitable_points_auxCPbis</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>).<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">IHm</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_000"><span class="id" type="lemma">proper_000</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">fun</span> (<span class="id" type="var">cp1</span> <span class="id" type="var">cp2</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqList"><span class="id" type="definition">SetOfTuplesOfPositiveOrderedType.eqList</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp1"><span class="id" type="variable">cp1</span></a>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp2"><span class="id" type="variable">cp2</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>)<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)) =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCPbis"><span class="id" type="definition">have_tuple_suitable_points_auxCPbis</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">cp1</span> <span class="id" type="var">cp2</span> <span class="id" type="var">HEqST</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HEqST</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">HEqST</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hf</span> [<span class="id" type="var">Hs</span> <span class="id" type="var">Hclear</span>]]; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hclear</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hf</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Htl</span> : <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqList"><span class="id" type="definition">SetOfTuplesOfPositiveOrderedType.eqList</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#tl"><span class="id" type="definition">tl</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp1</span>)) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#tl"><span class="id" type="definition">tl</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HEqST</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">HEqST</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hf</span> [<span class="id" type="var">Hs</span> <span class="id" type="var">Htl</span>]]; <span class="id" type="tactic">split</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HEqST</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">HEqST</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hhd</span> <span class="id" type="var">Hclear</span>]; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hclear</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hhd</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="arity.html#CPToListTl2"><span class="id" type="lemma">CPToListTl2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Htl</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Htl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Htl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Htl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="have_tuple_suitable_points_auxCPbisOK"><span class="id" type="lemma">have_tuple_suitable_points_auxCPbisOK</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> <span class="id" type="var">s</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCPbis"><span class="id" type="definition">have_tuple_suitable_points_auxCPbis</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">cp</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHm</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <a class="idref" href="sets.html#OCPOK"><span class="id" type="lemma">OCPOK</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>))).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHm</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="arity.html#CPToListTl2"><span class="id" type="lemma">CPToListTl2</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#OCPSortedTl"><span class="id" type="lemma">OCPSortedTl</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#OCPSortedAux"><span class="id" type="lemma">OCPSortedAux</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) (<span class="id" type="var">t</span> : <a class="idref" href="sets.html#ST.elt"><span class="id" type="definition">ST.elt</span></a>) := <a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#t"><span class="id" type="variable">t</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_00"><span class="id" type="lemma">proper_00</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">fun</span> (<span class="id" type="var">t1</span> <span class="id" type="var">t2</span> : <a class="idref" href="sets.html#ST.elt"><span class="id" type="definition">ST.elt</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eq"><span class="id" type="axiom">SetOfTuplesOfPositiveOrderedType.eq</span></a> <a class="idref" href="CoappR.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="CoappR.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>)<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> : <a class="idref" href="sets.html#ST.elt"><span class="id" type="definition">ST.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#t"><span class="id" type="variable">t</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eq"><span class="id" type="axiom">SetOfTuplesOfPositiveOrderedType.eq</span></a>.<br/>
<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCPbisOK"><span class="id" type="lemma">have_tuple_suitable_points_auxCPbisOK</span></a>).<br/>
<span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_000"><span class="id" type="lemma">proper_000</span></a>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ht1</span> := <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListSortOCP"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListSortOCP</span></a> <span class="id" type="var">t1</span>).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Ht2</span> := <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListSortOCP"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListSortOCP</span></a> <span class="id" type="var">t2</span>).<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListTrans"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListTrans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="sets.html#PosSort.sort"><span class="id" type="definition">sets.PosSort.sort</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">t1</span>)); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListTrans"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListTrans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="sets.html#PosSort.sort"><span class="id" type="definition">sets.PosSort.sort</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">t2</span>)); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListSym"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListSym</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) (<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#ST.exists_"><span class="id" type="definition">ST.exists_</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_0"><span class="id" type="lemma">proper_0</span></a> : <br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>)<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x1</span> <span class="id" type="var">y1</span> <span class="id" type="var">HXY1</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x2</span> <span class="id" type="var">y2</span> <span class="id" type="var">HXY2</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HXY2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HXY2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">x2</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a>;<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="sets.html#ST.exists_"><span class="id" type="definition">ST.exists_</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="sets.html#ST.Raw.exists_"><span class="id" type="definition">ST.Raw.exists_</span></a>.<br/>
<span class="id" type="tactic">induction</span> (<a class="idref" href="sets.html#ST.this"><span class="id" type="projection">ST.this</span></a> <span class="id" type="var">y2</span>); <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHt</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHt</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEqMem</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">e</span>, <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <span class="id" type="var">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_m"><span class="id" type="instance">SWP.Dec.F.mem_m</span></a>; <span class="id" type="tactic">intuition</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HXY1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HF</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fix</span> <span class="id" type="var">F</span> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a>)) -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="keyword">as</span> <span class="id" type="var">n0</span> <span class="id" type="keyword">return</span> (<a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#n0"><span class="id" type="variable">n0</span></a>)) -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">t0</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> 2 =&gt; <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">x1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n0</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">t0</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n0</span>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="CoappR.html#F"><span class="id" type="variable">F</span></a> <span class="id" type="var">n0</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>) <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="CoappR.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fix</span> <span class="id" type="var">F</span> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a>)) -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="keyword">as</span> <span class="id" type="var">n0</span> <span class="id" type="keyword">return</span> (<a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#n0"><span class="id" type="variable">n0</span></a>)) -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">t0</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> 2 =&gt; <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">y1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n0</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">t0</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n0</span>))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>)) <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="CoappR.html#F"><span class="id" type="variable">F</span></a> <span class="id" type="var">n0</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#t0"><span class="id" type="variable">t0</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>) <a class="idref" href="CoappR.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="CoappR.html#a"><span class="id" type="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEqMem</span>); <span class="id" type="tactic">reflexivity</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> ; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEqMem</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHn</span>; <span class="id" type="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HF</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_1"><span class="id" type="lemma">proper_1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">s1</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>)<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">st</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">HXY</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEqI</span> : <a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">x</span>) (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">y</span>))<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.inter_equal_2"><span class="id" type="lemma">SWP.inter_equal_2</span></a>; <span class="id" type="tactic">assumption</span>).<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_0"><span class="id" type="lemma">proper_0</span></a>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="var">f</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>) (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.choose"><span class="id" type="definition">SS.choose</span></a> (<a class="idref" href="sets.html#SS.filter"><span class="id" type="definition">SS.filter</span></a> <a class="idref" href="CoappR.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="exists_witness_ok"><span class="id" type="lemma">exists_witness_ok</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">e</span> <span class="id" type="var">f</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>) <a class="idref" href="CoappR.html#f"><span class="id" type="variable">f</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <a class="idref" href="CoappR.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> -&gt; <a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">f</span> <span class="id" type="var">s</span> <span class="id" type="var">HP</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_2"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_2</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.choose_mem_1"><span class="id" type="lemma">SSWEqP.choose_mem_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#SSWEqP.filter_mem"><span class="id" type="lemma">SSWEqP.filter_mem</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> (<span class="id" type="var">s1</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">ss</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> ((<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">i</span> := <a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> <a class="idref" href="CoappR.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>)) <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">s2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> (<span class="id" type="var">ss</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>) (<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> (<a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>) <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s1</span> =&gt; <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="var">s1</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="eqop"><span class="id" type="definition">eqop</span></a> (<span class="id" type="var">p1</span> <span class="id" type="var">p2</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#p1"><span class="id" type="variable">p1</span></a>,<a class="idref" href="CoappR.html#p2"><span class="id" type="variable">p2</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s1</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_2"><span class="id" type="lemma">proper_2</span></a> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">f1</span> <span class="id" type="var">f2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> -&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>) (<span class="id" type="var">s1</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>) <a class="idref" href="CoappR.html#f1"><span class="id" type="variable">f1</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>) <a class="idref" href="CoappR.html#f2"><span class="id" type="variable">f2</span></a> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>, <a class="idref" href="CoappR.html#f1"><span class="id" type="variable">f1</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#f2"><span class="id" type="variable">f2</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.Equal"><span class="id" type="definition">SS.Equal</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#eqop"><span class="id" type="definition">eqop</span></a> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <a class="idref" href="CoappR.html#f1"><span class="id" type="variable">f1</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a>) (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <a class="idref" href="CoappR.html#f2"><span class="id" type="variable">f2</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">H1</span> <span class="id" type="var">H2</span> <span class="id" type="var">H3</span> <span class="id" type="var">H4</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#eqop"><span class="id" type="definition">eqop</span></a>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<a class="idref" href="sets.html#SS.Equal"><span class="id" type="definition">SS.Equal</span></a> (<a class="idref" href="sets.html#SS.filter"><span class="id" type="definition">SS.filter</span></a> <span class="id" type="var">f1</span> <span class="id" type="var">s1</span>) (<a class="idref" href="sets.html#SS.filter"><span class="id" type="definition">SS.filter</span></a> <span class="id" type="var">f2</span> <span class="id" type="var">s2</span>)) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.filter_ext"><span class="id" type="lemma">SSWEqP.MP.Dec.F.filter_ext</span></a>; <span class="id" type="tactic">assumption</span>).<br/>
<span class="id" type="var">case_eq</span> (<a class="idref" href="sets.html#SS.choose"><span class="id" type="definition">SS.choose</span></a> (<a class="idref" href="sets.html#SS.filter"><span class="id" type="definition">SS.filter</span></a> <span class="id" type="var">f1</span> <span class="id" type="var">s1</span>)); <span class="id" type="var">case_eq</span> (<a class="idref" href="sets.html#SS.choose"><span class="id" type="definition">SS.choose</span></a> (<a class="idref" href="sets.html#SS.filter"><span class="id" type="definition">SS.filter</span></a> <span class="id" type="var">f2</span> <span class="id" type="var">s2</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">HCN</span> <span class="id" type="var">e</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SS.choose_spec1"><span class="id" type="lemma">SS.choose_spec1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SS.choose_spec2"><span class="id" type="lemma">SS.choose_spec2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.empty_is_empty_1"><span class="id" type="lemma">SSWEqP.MP.empty_is_empty_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCN</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.empty_iff"><span class="id" type="lemma">SSWEqP.MP.Dec.F.empty_iff</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">eassumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">HCS</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SS.choose_spec1"><span class="id" type="lemma">SS.choose_spec1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SS.choose_spec2"><span class="id" type="lemma">SS.choose_spec2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.empty_is_empty_1"><span class="id" type="lemma">SSWEqP.MP.empty_is_empty_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCN</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.empty_iff"><span class="id" type="lemma">SSWEqP.MP.Dec.F.empty_iff</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">eassumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="eqopp"><span class="id" type="definition">eqopp</span></a> (<span class="id" type="var">p1</span> <span class="id" type="var">p2</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#p1"><span class="id" type="variable">p1</span></a>,<a class="idref" href="CoappR.html#p2"><span class="id" type="variable">p2</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s1</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">s2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="proper_3"><span class="id" type="lemma">proper_3</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="sets.html#SS.Equal"><span class="id" type="definition">SS.Equal</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="CoappR.html#eqopp"><span class="id" type="definition">eqopp</span></a>) <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x1</span> <span class="id" type="var">y1</span> <span class="id" type="var">HXY1</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x2</span> <span class="id" type="var">y2</span> <span class="id" type="var">HXY2</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x3</span> <span class="id" type="var">y3</span> <span class="id" type="var">HXY3</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HXY3</span>.<br/>
<span class="id" type="tactic">assert</span> (<a class="idref" href="CoappR.html#eqop"><span class="id" type="definition">eqop</span></a> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">x1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">y3</span>) <span class="id" type="var">x2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">y1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">y3</span>) <span class="id" type="var">y2</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_2"><span class="id" type="lemma">proper_2</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_1"><span class="id" type="lemma">proper_1</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_1"><span class="id" type="lemma">proper_1</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_0"><span class="id" type="lemma">proper_0</span></a>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.inter_equal_1"><span class="id" type="lemma">SWP.inter_equal_1</span></a>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">y1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">y3</span>) <span class="id" type="var">y2</span>);<br/>
<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">x1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">y3</span>) <span class="id" type="var">x2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">HCN</span> <span class="id" type="var">e</span> <span class="id" type="var">HCS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCS</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCN</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">HCS</span> <span class="id" type="var">HCN</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCS</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HCN</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="get_suitable_pair_of_sets_ok_1"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span> <span class="id" type="keyword">with</span> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> <span class="id" type="keyword">end</span>) <span class="id" type="var">ss</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e1</span> <span class="id" type="var">HEW1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">e1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">st</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">ss</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e2</span> <span class="id" type="var">HEW2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEq1</span> : <span class="id" type="var">e1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">s1</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">injection</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq1</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEq2</span> : <span class="id" type="var">e2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">s2</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">injection</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq2</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#exists_witness_ok"><span class="id" type="lemma">exists_witness_ok</span></a> <span class="id" type="keyword">with</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span> <span class="id" type="keyword">with</span> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> <span class="id" type="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">HXY</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<a class="idref" href="sets.html#SS.Equal"><span class="id" type="definition">SS.Equal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">ss</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">y</span> <span class="id" type="var">ss</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWP.Dec.F.remove_m"><span class="id" type="instance">SSWP.Dec.F.remove_m</span></a>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>; <span class="id" type="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<a class="idref" href="CoappR.html#eqopp"><span class="id" type="definition">eqopp</span></a> (<a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="var">x</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span>) (<a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="var">y</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">y</span> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_3"><span class="id" type="lemma">proper_3</span></a>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="var">x</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">x</span> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="var">y</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">y</span> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H3</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#eqop"><span class="id" type="definition">eqop</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H3</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#eqop"><span class="id" type="definition">eqop</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">discriminate</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="get_suitable_pair_of_sets_ok_2"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_2</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span> <span class="id" type="keyword">with</span> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> | <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> <span class="id" type="keyword">end</span>) <span class="id" type="var">ss</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e1</span> <span class="id" type="var">HEW1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">e1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">st</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">ss</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e2</span> <span class="id" type="var">HEW2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEq1</span> : <span class="id" type="var">e1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">s1</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">injection</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq1</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEq2</span> : <span class="id" type="var">e2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">s2</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">injection</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq2</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#exists_witness_ok"><span class="id" type="lemma">exists_witness_ok</span></a> <span class="id" type="keyword">with</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">s1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">st</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">HXY</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_1"><span class="id" type="lemma">proper_1</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">discriminate</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Function</span> <span class="id" type="var">compute_new_set_of_sets_of_coapp_points</span> (<span class="id" type="var">ss</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" type="keyword">measure</span> <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> <span class="id" type="var">ss</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">suitablepairofsets</span> := <a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#suitablepairofsets"><span class="id" type="variable">suitablepairofsets</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">s1</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">s2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">auxsetofsets</span> := <a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">auxset</span> := <a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newss</span> := <a class="idref" href="sets.html#SS.add"><span class="id" type="definition">SS.add</span></a> <a class="idref" href="CoappR.html#auxset"><span class="id" type="variable">auxset</span></a> <a class="idref" href="CoappR.html#auxsetofsets"><span class="id" type="variable">auxsetofsets</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points"><span class="id" type="definition">compute_new_set_of_sets_of_coapp_points</span></a> <a class="idref" href="CoappR.html#newss"><span class="id" type="variable">newss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>)) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> <span class="id" type="var">ss</span>).<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWP.remove_cardinal_1"><span class="id" type="lemma">SSWP.remove_cardinal_1</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_ok_1"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">s2</span> <span class="id" type="var">st</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>)))) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))).<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Peano.html#eq_S"><span class="id" type="definition">eq_S</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWP.remove_cardinal_1"><span class="id" type="lemma">SSWP.remove_cardinal_1</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_ok_2"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">st</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HR1</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>)))) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> <span class="id" type="var">ss</span>).<br/>
<span class="id" type="tactic">transitivity</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>(<a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))); <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">elim</span> (<a class="idref" href="CoappR.html#SSWP.In_dec"><span class="id" type="lemma">SSWP.In_dec</span></a> (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))); <span class="id" type="tactic">intro</span> <span class="id" type="var">HDec</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HR2</span> : <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.add"><span class="id" type="definition">SS.add</span></a> (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWP.add_cardinal_1"><span class="id" type="lemma">SSWP.add_cardinal_1</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HR2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HR1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HR2</span> : <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.add"><span class="id" type="definition">SS.add</span></a> (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>))) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a>( <a class="idref" href="sets.html#SS.cardinal"><span class="id" type="definition">SS.cardinal</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s2</span> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">ss</span>)))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWP.add_cardinal_2"><span class="id" type="lemma">SSWP.add_cardinal_2</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HR2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HR1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="memCPAux"><span class="id" type="definition">memCPAux</span></a> <span class="id" type="var">m</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span>).<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">IHm</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>))<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">)</span></a>).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPAuxHdTl"><span class="id" type="lemma">memCPAuxHdTl</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>)) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:bool_scope:x_'&&'_x"><span class="id" type="notation">&amp;&amp;</span></a> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>)) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPAuxProperOK"><span class="id" type="lemma">memCPAuxProperOK</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>) (<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">m</span> <span class="id" type="var">cp1</span> <span class="id" type="var">cp2</span> <span class="id" type="var">Hcp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">Hs</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hcp</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hcp</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">cp1</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">cp2</span> <span class="id" type="var">into</span> <span class="id" type="var">cp</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="var">s1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="var">s2</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">intro</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_m"><span class="id" type="instance">SWP.Dec.F.mem_m</span></a>; <span class="id" type="tactic">trivial</span>).<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>); <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHm</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">e</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt; <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> -&gt; <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">e</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">subst</span>; <span class="id" type="var">spliter</span>; <span class="id" type="tactic">auto</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">e</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">spliter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span> <span class="id" type="keyword">with</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">spliter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memMemCPAuxOK"><span class="id" type="lemma">memMemCPAuxOK</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">e</span>, <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> -&gt; <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) -&gt; <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn1</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn2</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#memCPAuxHdTl"><span class="id" type="lemma">memCPAuxHdTl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">assumption</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#InCPOCP"><span class="id" type="lemma">InCPOCP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPAuxTlOK"><span class="id" type="lemma">memCPAuxTlOK</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span> <span class="id" type="var">Hmemcp</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memMemCPAuxOK"><span class="id" type="lemma">memMemCPAuxOK</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m</span>) <span class="id" type="var">cp</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a>.<br/>
<span class="id" type="tactic">right</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="memCP"><span class="id" type="definition">memCP</span></a> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a>)))) (<span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>) := <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPProper"><span class="id" type="lemma">memCPProper</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#Proper"><span class="id" type="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Classes.Morphisms.html#ProperNotations.:signature_scope:x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a>) <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxProperOK"><span class="id" type="lemma">memCPAuxProperOK</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memMemCPOK"><span class="id" type="lemma">memMemCPOK</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">cp</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">e</span>, <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> -&gt; <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) -&gt; <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memMemCPAuxOK"><span class="id" type="lemma">memMemCPAuxOK</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPConsHd"><span class="id" type="lemma">memCPConsHd</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">s</span> <span class="id" type="var">x</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> (<a class="idref" href="arity.html#consHeadCP"><span class="id" type="definition">consHeadCP</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">s</span> <span class="id" type="var">x</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">Hmemcp</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memMemCPOK"><span class="id" type="lemma">memMemCPOK</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a> <span class="id" type="var">x</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="test_coapp"><span class="id" type="definition">test_coapp</span></a> (<span class="id" type="var">ss</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>) (<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>) (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a>)))) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newss</span> := <a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points"><span class="id" type="lemma">compute_new_set_of_sets_of_coapp_points</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>  <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="sets.html#SS.exists_"><span class="id" type="definition">SS.exists_</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> =&gt; <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a>) <a class="idref" href="CoappR.html#newss"><span class="id" type="variable">newss</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="htspa_memCPAux1"><span class="id" type="lemma">htspa_memCPAux1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">m</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a>); <span class="id" type="tactic">intro</span> <span class="id" type="var">Hhtspa</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.inter_b"><span class="id" type="lemma">SWP.FM.inter_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hhtspa</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hhtspa</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">tauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hhtspa</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hmem</span> <span class="id" type="var">Hhtspa</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.inter_b"><span class="id" type="lemma">SWP.FM.inter_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">try</span> (<span class="id" type="var">spliter</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="htspa_memCPAux2"><span class="id" type="lemma">htspa_memCPAux2</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">m</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_auxCP"><span class="id" type="definition">have_tuple_suitable_points_auxCP</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a>); <span class="id" type="tactic">intro</span> <span class="id" type="var">Hhtspa</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.inter_b"><span class="id" type="lemma">SWP.FM.inter_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hhtspa</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hhtspa</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">tauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hhtspa</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hmem</span> <span class="id" type="var">Hhtspa</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.inter_b"><span class="id" type="lemma">SWP.FM.inter_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">try</span> (<span class="id" type="var">spliter</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <a name="Coapp_refl"><span class="id" type="section">Coapp_refl</span></a>.<br/>

<br/>
<span class="id" type="keyword">Context</span> {<span class="id" type="var">COP</span> : <a class="idref" href="tactics_axioms.html#Coapp_predicates"><span class="id" type="class">Coapp_predicates</span></a> <a class="idref" href="sets.html#Ar"><span class="id" type="axiom">Ar</span></a>}.<br/>
<span class="id" type="keyword">Context</span> {<span class="id" type="var">COT</span> : <a class="idref" href="tactics_axioms.html#Coapp_theory"><span class="id" type="class">Coapp_theory</span></a> <a class="idref" href="sets.html#Ar"><span class="id" type="axiom">Ar</span></a> <a class="idref" href="CoappR.html#Coapp_refl.COP"><span class="id" type="variable">COP</span></a>}.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="interp_CP"><span class="id" type="definition">interp_CP</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)) (<span class="id" type="var">interp</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> -&gt; <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a>) : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">interp</span> <span class="id" type="var">cp</span>).<br/>
<span class="id" type="tactic">clear</span> <span class="id" type="var">IHm</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">interp</span> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>)).<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">interp</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)).<br/>
<span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">interp</span> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>)).<br/>
<span class="id" type="tactic">exact</span> (<span class="id" type="var">IHm</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="interp_CPHdOK"><span class="id" type="lemma">interp_CPHdOK</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)) <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> (<a class="idref" href="arity.html#headCPbis"><span class="id" type="definition">headCPbis</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="interp_CPTlOK"><span class="id" type="lemma">interp_CPTlOK</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="interp_CPOK"><span class="id" type="lemma">interp_CPOK</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)) (<span class="id" type="var">interp</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> -&gt; <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">interp</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">clear</span> <span class="id" type="var">IHm0</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="arity.html#CPToListOK"><span class="id" type="lemma">CPToListOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPHdOK"><span class="id" type="lemma">interp_CPHdOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPTlOK"><span class="id" type="lemma">interp_CPTlOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="ss_ok"><span class="id" type="definition">ss_ok</span></a> (<span class="id" type="var">ss</span> : <a class="idref" href="sets.html#SS.t"><span class="id" type="definition">SS.t</span></a>) (<span class="id" type="var">interp</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> -&gt; <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">s</span>, <a class="idref" href="sets.html#SS.mem"><span class="id" type="definition">SS.mem</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt; <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">cp</span>, <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="consHdInterpOK"><span class="id" type="lemma">consHdInterpOK</span></a> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> 1) (<span class="id" type="var">x</span> : <a class="idref" href="sets.html#ST.elt"><span class="id" type="definition">ST.elt</span></a>) <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#consHeadCP"><span class="id" type="definition">consHeadCP</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> (<a class="idref" href="arity.html#consHeadCP"><span class="id" type="definition">consHeadCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">x</span> <span class="id" type="var">interp</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#CP_ind"><span class="id" type="lemma">CP_ind</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="ss_ok_inter_ok1"><span class="id" type="lemma">ss_ok_inter_ok1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">x</span> (<span class="id" type="var">p</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> 1),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app_1_n"><span class="id" type="definition">app_1_n</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">x</span> <span class="id" type="var">p</span> <span class="id" type="var">HSSOK</span> <span class="id" type="var">HIn</span> <span class="id" type="var">HInter</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#app_app_1_n"><span class="id" type="lemma">app_app_1_n</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="arity.html#consHeadCP"><span class="id" type="definition">consHeadCP</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">p</span> <span class="id" type="var">interp</span>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">x</span> <span class="id" type="var">interp</span>)); <span class="id" type="tactic">try</span> (<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hmemcp</span> : <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a> <span class="id" type="var">x</span> <span class="id" type="var">s1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#htspa_memCPAux1"><span class="id" type="lemma">htspa_memCPAux1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>).<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HSSOK</span>.<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#consHdInterpOK"><span class="id" type="lemma">consHdInterpOK</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">HSSOK</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s1</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPConsHd"><span class="id" type="lemma">memCPConsHd</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="ss_ok_inter_ok2"><span class="id" type="lemma">ss_ok_inter_ok2</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">x</span> (<span class="id" type="var">p</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> 1),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app_1_n"><span class="id" type="definition">app_1_n</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">x</span> <span class="id" type="var">p</span> <span class="id" type="var">HSSOK</span> <span class="id" type="var">HIn</span> <span class="id" type="var">HInter</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#app_app_1_n"><span class="id" type="lemma">app_app_1_n</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="arity.html#consHeadCP"><span class="id" type="definition">consHeadCP</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">p</span> <span class="id" type="var">interp</span>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">x</span> <span class="id" type="var">interp</span>)); <span class="id" type="tactic">try</span> (<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>).<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hmemcp</span> : <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a> <span class="id" type="var">x</span> <span class="id" type="var">s2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#htspa_memCPAux2"><span class="id" type="lemma">htspa_memCPAux2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">s1</span>; <span class="id" type="tactic">assumption</span>).<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HSSOK</span>.<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#consHdInterpOK"><span class="id" type="lemma">consHdInterpOK</span></a>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">HSSOK</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPConsHd"><span class="id" type="lemma">memCPConsHd</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="mca_htspa_pca"><span class="id" type="lemma">mca_htspa_pca</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">m</span> <span class="id" type="var">cp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">x</span> <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#SS.In"><span class="id" type="definition">SS.In</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#have_tuple_suitable_points_aux"><span class="id" type="definition">have_tuple_suitable_points_aux</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <a class="idref" href="CoappR.html#s1"><span class="id" type="variable">s1</span></a> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#pred_conj_aux"><span class="id" type="definition">pred_conj_aux</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span> <span class="id" type="var">x</span> <span class="id" type="var">interp</span> <span class="id" type="var">HSSOK</span> <span class="id" type="var">HIn1</span> <span class="id" type="var">HIn2</span> <span class="id" type="var">Hmemcp</span> <span class="id" type="var">Hhtspa</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#pred_conj_aux"><span class="id" type="definition">pred_conj_aux</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat_rect"><span class="id" type="definition">nat_rect</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HElim</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> 1 <span class="id" type="var">cp</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.union_b"><span class="id" type="lemma">SWP.FM.union_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HElim</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok1"><span class="id" type="lemma">ss_ok_inter_ok1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok2"><span class="id" type="lemma">ss_ok_inter_ok2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HElim</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)) (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> 1 <span class="id" type="var">cp</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.union_b"><span class="id" type="lemma">SWP.FM.union_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HElim</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok1"><span class="id" type="lemma">ss_ok_inter_ok1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok2"><span class="id" type="lemma">ss_ok_inter_ok2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HElim</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>)) (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> 1 <span class="id" type="var">cp</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.union_b"><span class="id" type="lemma">SWP.FM.union_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HElim</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok1"><span class="id" type="lemma">ss_ok_inter_ok1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok2"><span class="id" type="lemma">ss_ok_inter_ok2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="arity.html#pcaHdTl"><span class="id" type="lemma">pcaHdTl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">cp</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HElim</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="sets.html#S.union"><span class="id" type="definition">S.union</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m</span>)) <span class="id" type="var">cp</span>; <span class="id" type="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.FM.union_b"><span class="id" type="lemma">SWP.FM.union_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HElim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HElim</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HElim</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok1"><span class="id" type="lemma">ss_ok_inter_ok1</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#ss_ok_inter_ok2"><span class="id" type="lemma">ss_ok_inter_ok2</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">ss</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPTlOK"><span class="id" type="lemma">interp_CPTlOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxTlOK"><span class="id" type="lemma">memCPAuxTlOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="st_ok"><span class="id" type="definition">st_ok</span></a> (<span class="id" type="var">st</span> : <a class="idref" href="sets.html#ST.t"><span class="id" type="definition">ST.t</span></a>) (<span class="id" type="var">interp</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> -&gt; <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">t</span>, <a class="idref" href="sets.html#ST.mem"><span class="id" type="definition">ST.mem</span></a> <a class="idref" href="CoappR.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt; <a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#wd"><span class="id" type="method">wd</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="compute_new_set_of_sets_of_coapp_points_ok"><span class="id" type="lemma">compute_new_set_of_sets_of_coapp_points_ok</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> (<a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points"><span class="id" type="lemma">compute_new_set_of_sets_of_coapp_points</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span> <span class="id" type="var">HSS</span> <span class="id" type="var">HST</span>.<br/>
<span class="id" type="tactic">apply</span> (<span class="id" type="keyword">let</span> <span class="id" type="var">P</span> <span class="id" type="var">interp</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">newss</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#newss"><span class="id" type="variable">newss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points_ind"><span class="id" type="definition">compute_new_set_of_sets_of_coapp_points_ind</span></a> (<a class="idref" href="CoappR.html#P"><span class="id" type="variable">P</span></a> <span class="id" type="var">interp</span>)); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">HSS</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HST</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">suitablepairofsets</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">Hs1s2</span> <span class="id" type="var">auxsetofsets</span> <span class="id" type="var">auxset</span> <span class="id" type="var">newss</span> <span class="id" type="var">H</span> <span class="id" type="var">HSS</span> <span class="id" type="var">HST</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hs1</span> := <span class="id" type="var">Hs1s2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hs2</span> := <span class="id" type="var">Hs1s2</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_ok_1"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_ok_2"><span class="id" type="lemma">get_suitable_pair_of_sets_ok_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.remove_3"><span class="id" type="lemma">SSWEqP.MP.Dec.F.remove_3</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">cp</span> <span class="id" type="var">Hmemcp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">newss</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">newss</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">elim</span> (<a class="idref" href="sets.html#SS.E.eq_dec"><span class="id" type="axiom">SS.E.eq_dec</span></a> <span class="id" type="var">auxset</span> <span class="id" type="var">s</span>); <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HEq'</span> : <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">auxset</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">s</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPProper"><span class="id" type="lemma">memCPProper</span></a>; <span class="id" type="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HEq</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HEq'</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">suitablepairofsets</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs1s2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">suitablepairofsets</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets"><span class="id" type="definition">get_suitable_pair_of_sets</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs1s2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">ss</span>) <span class="id" type="var">st</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>) <span class="id" type="var">ss</span>); <span class="id" type="tactic">try</span> (<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e1</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#get_suitable_pair_of_sets_aux"><span class="id" type="definition">get_suitable_pair_of_sets_aux</span></a> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">s2</span> : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a> =&gt; <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">e1</span> <a class="idref" href="CoappR.html#s2"><span class="id" type="variable">s2</span></a>) <span class="id" type="var">st</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="sets.html#SS.remove"><span class="id" type="definition">SS.remove</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">ss</span>)); <span class="id" type="tactic">try</span> (<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">e2</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">injection</span> <span class="id" type="var">Hs1s2</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">He2s2</span> <span class="id" type="var">He1s1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">He2s2</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">He1s1</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">clear</span> <span class="id" type="var">He2s2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">He1s1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hs1s2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">e2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">case_eq</span> (<a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> (<a class="idref" href="sets.html#S.inter"><span class="id" type="definition">S.inter</span></a> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span>) <span class="id" type="var">st</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#have_tuple_suitable_points"><span class="id" type="definition">have_tuple_suitable_points</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#STWEqP.exists_mem_4"><span class="id" type="lemma">STWEqP.exists_mem_4</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEW</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> (<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">Hxy</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hxy</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hxyfst</span> <span class="id" type="var">Hxysnd</span>]; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hxyfst</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hxysnd</span>; <span class="id" type="tactic">reflexivity</span>); <span class="id" type="tactic">try</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_00"><span class="id" type="lemma">proper_00</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">HEW</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">x</span> [<span class="id" type="var">HmemST1</span> <span class="id" type="var">HmemST2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">HST</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HmemST1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="tactics_axioms.html#coapp_n"><span class="id" type="method">coapp_n</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">x</span> <span class="id" type="var">interp</span>); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#pred_conj"><span class="id" type="definition">pred_conj</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#mca_htspa_pca"><span class="id" type="lemma">mca_htspa_pca</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">s1</span> <span class="id" type="var">s2</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">HEW2</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#exists_witness"><span class="id" type="definition">exists_witness</span></a> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SS.choose_spec1"><span class="id" type="lemma">SS.choose_spec1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.filter_2"><span class="id" type="lemma">SSWEqP.MP.Dec.F.filter_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEW</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#proper_1"><span class="id" type="lemma">proper_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEW2</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">discriminate</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#SSWP.Dec.F.add_neq_b"><span class="id" type="lemma">SSWP.Dec.F.add_neq_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">HSS</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">auxsetofsets</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_2"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.remove_3"><span class="id" type="lemma">SSWEqP.MP.Dec.F.remove_3</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="test_coap_ok"><span class="id" type="lemma">test_coap_ok</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span> <span class="id" type="var">cp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#test_coapp"><span class="id" type="definition">test_coapp</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">ss</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span> <span class="id" type="var">cp</span> <span class="id" type="var">HSS</span> <span class="id" type="var">HST</span> <span class="id" type="var">HTC</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#test_coapp"><span class="id" type="definition">test_coapp</span></a> <span class="id" type="keyword">in</span> *.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HSS2</span> : <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> (<a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points"><span class="id" type="lemma">compute_new_set_of_sets_of_coapp_points</span></a> <span class="id" type="var">ss</span> <span class="id" type="var">st</span>) <span class="id" type="var">interp</span>)<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#compute_new_set_of_sets_of_coapp_points_ok"><span class="id" type="lemma">compute_new_set_of_sets_of_coapp_points_ok</span></a>; <span class="id" type="tactic">assumption</span>).<br/>

<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HSS2</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.exists_2"><span class="id" type="lemma">SSWEqP.MP.Dec.F.exists_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HTC</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="sets.html#SS.Exists"><span class="id" type="definition">SS.Exists</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HTC</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">HTC</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">s</span> [<span class="id" type="var">HIn</span> <span class="id" type="var">Hmem</span>]].<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">HSS2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_1</span></a>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">assumption</span>.<br/>

<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">Hxy</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPProper"><span class="id" type="lemma">memCPProper</span></a>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="ss_ok_empty"><span class="id" type="lemma">ss_ok_empty</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">interp</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="sets.html#SS.empty"><span class="id" type="definition">SS.empty</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">interp</span> <span class="id" type="var">ss</span> <span class="id" type="var">Hmem1</span> <span class="id" type="var">cp</span> <span class="id" type="var">Hmem2</span>.<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.empty_b"><span class="id" type="lemma">SSWEqP.MP.Dec.F.empty_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>.<br/>
<span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="st_ok_empty"><span class="id" type="lemma">st_ok_empty</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">interp</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <a class="idref" href="sets.html#ST.empty"><span class="id" type="definition">ST.empty</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">Ht</span>.<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#STWEqP.MP.Dec.F.empty_b"><span class="id" type="lemma">STWEqP.MP.Dec.F.empty_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Ht</span>.<br/>
<span class="id" type="tactic">discriminate</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="CPToSS"><span class="id" type="definition">CPToSS</span></a> {<span class="id" type="var">m</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>) : <a class="idref" href="sets.html#SS.elt"><span class="id" type="definition">SS.elt</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> <span class="id" type="var">cp</span> <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>).<br/>
<span class="id" type="tactic">exact</span> (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp</span>) (<span class="id" type="var">IHm</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp</span>))).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CPToSSHdTl"><span class="id" type="lemma">CPToSSHdTl</span></a> {<span class="id" type="var">m</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="memCPToSSOK"><span class="id" type="lemma">memCPToSSOK</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} : <span class="id" type="keyword">forall</span> <span class="id" type="var">e</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)),<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">e</span> <span class="id" type="var">cp</span> <span class="id" type="var">Hmem</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="sets.html#SWP.singleton_equal_add"><span class="id" type="lemma">SWP.singleton_equal_add</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#CPToSSHdTl"><span class="id" type="lemma">CPToSSHdTl</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.Dec.F.add_b"><span class="id" type="lemma">SWP.Dec.F.add_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="sets.html#SWP.Dec.F.singleton_b"><span class="id" type="lemma">SWP.Dec.F.singleton_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">Hmem</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CPToSSOKAux"><span class="id" type="lemma">CPToSSOKAux</span></a> {<span class="id" type="var">m</span> <span class="id" type="var">m'</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>))) (<span class="id" type="var">cp'</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m'"><span class="id" type="variable">m'</span></a>))) <span class="id" type="var">e</span> <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> <a class="idref" href="CoappR.html#m'"><span class="id" type="variable">m'</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">m'</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> <span class="id" type="var">e</span> <span class="id" type="var">s</span> <span class="id" type="var">HEq</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HPerm</span> := <a class="idref" href="sets.html#OCPPerm"><span class="id" type="lemma">OCPPerm</span></a> <span class="id" type="var">cp'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_length_2"><span class="id" type="lemma">Permutation.Permutation_length_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#andb_true_iff"><span class="id" type="lemma">andb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hmem</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">Hmem1</span> <span class="id" type="var">Hmem2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) <span class="id" type="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.FM.mem_m"><span class="id" type="instance">SWP.FM.mem_m</span></a>; <span class="id" type="tactic">trivial</span>); <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) <span class="id" type="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.FM.mem_m"><span class="id" type="instance">SWP.FM.mem_m</span></a>; <span class="id" type="tactic">trivial</span>); <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.Dec.F.add_b"><span class="id" type="lemma">SWP.Dec.F.add_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="sets.html#SWP.Dec.F.singleton_b"><span class="id" type="lemma">SWP.Dec.F.singleton_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.singleton"><span class="id" type="definition">S.singleton</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.FM.mem_m"><span class="id" type="instance">SWP.FM.mem_m</span></a>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.singleton_equal_add"><span class="id" type="lemma">SWP.singleton_equal_add</span></a>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="sets.html#SWP.Dec.F.add_b"><span class="id" type="lemma">SWP.Dec.F.add_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="sets.html#SWP.Dec.F.singleton_b"><span class="id" type="lemma">SWP.Dec.F.singleton_b</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.add"><span class="id" type="definition">S.add</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="sets.html#S.empty"><span class="id" type="definition">S.empty</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="sets.html#S.mem"><span class="id" type="definition">S.mem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> (<a class="idref" href="sets.html#OCP"><span class="id" type="definition">OCP</span></a> <span class="id" type="var">cp'</span>)) (<a class="idref" href="sets.html#S.singleton"><span class="id" type="definition">S.singleton</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#snd"><span class="id" type="definition">snd</span></a> <span class="id" type="var">cp</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.FM.mem_m"><span class="id" type="instance">SWP.FM.mem_m</span></a>; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.singleton_equal_add"><span class="id" type="lemma">SWP.singleton_equal_add</span></a>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Bool.Bool.html#orb_true_iff"><span class="id" type="lemma">orb_true_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HPerm</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HPerm</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">HEq</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">HEq1</span> <span class="id" type="var">HEq2</span>]; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq1</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq2</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">HEq</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">HEq1</span> <span class="id" type="var">HEq2</span>]; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq1</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq2</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem2</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.mem_2"><span class="id" type="lemma">SWP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SWP.Dec.F.singleton_1"><span class="id" type="lemma">SWP.Dec.F.singleton_1</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> 0 <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> 0 <span class="id" type="var">cp'</span> <span class="id" type="var">s</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxProperOK"><span class="id" type="lemma">memCPAuxProperOK</span></a>; <span class="id" type="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">cp'</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> 0 <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">H</span> <span class="id" type="var">into</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPToSSOK"><span class="id" type="lemma">memCPToSSOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> 0 <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> 0 <span class="id" type="var">cp'</span> <span class="id" type="var">s</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxProperOK"><span class="id" type="lemma">memCPAuxProperOK</span></a>; <span class="id" type="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">cp'</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> 0 <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">H</span> <span class="id" type="var">into</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPToSSOK"><span class="id" type="lemma">memCPToSSOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> <span class="id" type="var">e</span> <span class="id" type="var">s</span> <span class="id" type="var">HEq</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#InCPOK"><span class="id" type="lemma">InCPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HIn</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HmemEq</span> : <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m'</span>) <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#memCPAux"><span class="id" type="definition">memCPAux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m'</span>) <span class="id" type="var">cp'</span> <span class="id" type="var">s</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxProperOK"><span class="id" type="lemma">memCPAuxProperOK</span></a>; <span class="id" type="tactic">trivial</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HmemEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HmemEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">IHm'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HIn</span> : <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">cp'</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <a class="idref" href="CoappR.html#memCPAuxOK"><span class="id" type="lemma">memCPAuxOK</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m'</span>) <span class="id" type="var">cp'</span> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <span class="id" type="var">cp</span>) (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">Hmem</span> <span class="id" type="var">HIn</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HIn</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">H</span> <span class="id" type="var">into</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPToSSOK"><span class="id" type="lemma">memCPToSSOK</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHm'</span> <span class="id" type="keyword">with</span> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp'</span>) <span class="id" type="var">s</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#memCPAuxTlOK"><span class="id" type="lemma">memCPAuxTlOK</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CPToSSOK"><span class="id" type="lemma">CPToSSOK</span></a> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="tactics_axioms.html#n"><span class="id" type="method">n</span></a>)))) <span class="id" type="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="sets.html#S.Equal"><span class="id" type="definition">S.Equal</span></a> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#memCP"><span class="id" type="definition">memCP</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a> <a class="idref" href="CoappR.html#s"><span class="id" type="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#incl"><span class="id" type="definition">incl</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#incl"><span class="id" type="definition">incl</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> <span class="id" type="var">s</span> <span class="id" type="var">HEq</span> <span class="id" type="var">Hmem</span> <span class="id" type="var">e</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <a class="idref" href="CoappR.html#CPToSSOKAux"><span class="id" type="lemma">CPToSSOKAux</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> <span class="id" type="var">e</span> <span class="id" type="var">s</span> <span class="id" type="var">HEq</span> <span class="id" type="var">Hmem</span>).<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="arity.html#InCP"><span class="id" type="definition">InCP</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CoappDupPerm"><span class="id" type="lemma">CoappDupPerm</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">List.NoDup</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation"><span class="id" type="inductive">Permutation.Permutation</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> (<a class="idref" href="arity.html#ListToCP"><span class="id" type="definition">ListToCP</span></a> (<a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="CoappR.html#l"><span class="id" type="variable">l</span></a>) <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a>)) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">HDup</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#NotNoDupDup"><span class="id" type="lemma">NotNoDupDup</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HDup</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.PArith.BinPos.html#Pos.eq_dec"><span class="id" type="lemma">Pos.eq_dec</span></a>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">HDup</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">e</span> [<span class="id" type="var">l1</span> [<span class="id" type="var">l2</span> [<span class="id" type="var">HEq</span> <span class="id" type="var">HIn</span>]]]].<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#in_split"><span class="id" type="lemma">in_split</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HIn</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">HIn</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">l3</span> [<span class="id" type="var">l4</span> <span class="id" type="var">HEq'</span>]].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HPerm</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_middle"><span class="id" type="lemma">Permutation.Permutation_middle</span></a> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">e</span>).<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">HEq</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HEq'</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HEq'</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">l2</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">l3</span> <span class="id" type="var">into</span> <span class="id" type="var">l1</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">l4</span> <span class="id" type="var">into</span> <span class="id" type="var">l2</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HPerm'</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_middle"><span class="id" type="lemma">Permutation.Permutation_middle</span></a> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> <span class="id" type="var">e</span>).<br/>
<span class="id" type="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#perm_skip"><span class="id" type="constructor">Permutation.perm_skip</span></a> <span class="id" type="var">e</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm'</span>.<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">HPerm''</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#perm_trans"><span class="id" type="constructor">Permutation.perm_trans</span></a> <span class="id" type="var">HPerm'</span> <span class="id" type="var">HPerm</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HPerm</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HPerm'</span>; <span class="id" type="tactic">rename</span> <span class="id" type="var">HPerm''</span> <span class="id" type="var">into</span> <span class="id" type="var">HPerm</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="arity.html#CPLOK"><span class="id" type="lemma">CPLOK</span></a> <span class="id" type="keyword">with</span> (<span class="id" type="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">l1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <span class="id" type="var">l2</span>) <span class="id" type="var">e</span> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>.<br/>
<span class="id" type="tactic">exists</span> <span class="id" type="var">e</span>; <span class="id" type="tactic">exists</span> (<span class="id" type="var">l1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <span class="id" type="var">l2</span>); <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CoappDupAux"><span class="id" type="lemma">CoappDupAux</span></a> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> (<span class="id" type="var">cp</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m"><span class="id" type="variable">m</span></a>)))),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">List.NoDup</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">(</span></a><span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <span class="id" type="var">m'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">(</span></a><span class="id" type="var">cp'</span> : <a class="idref" href="arity.html#cartesianPower"><span class="id" type="definition">cartesianPower</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="CoappR.html#m'"><span class="id" type="variable">m'</span></a>)))<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">),</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation"><span class="id" type="inductive">Permutation.Permutation</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a> <a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">/\</span></a> <a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <a class="idref" href="CoappR.html#cp'"><span class="id" type="variable">cp'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#e"><span class="id" type="variable">e</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#CoappDupPerm"><span class="id" type="lemma">CoappDupPerm</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">e</span>[<span class="id" type="var">l</span> <span class="id" type="var">HPerm</span>]].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hl</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_length"><span class="id" type="lemma">Permutation.Permutation_length</span></a> <span class="id" type="var">HPerm</span>).<br/>
<span class="id" type="tactic">rewrite</span> <a class="idref" href="arity.html#CPLOK"><span class="id" type="lemma">CPLOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hl</span>.<br/>
<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="arity.html#lengthOfCPToList"><span class="id" type="lemma">lengthOfCPToList</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hl</span>.<br/>
<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hl</span>; <span class="id" type="tactic">discriminate</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">IHl</span>.<br/>
<span class="id" type="tactic">exists</span> <span class="id" type="var">e</span>; <span class="id" type="tactic">exists</span> (<span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">l</span>); <span class="id" type="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> <span class="id" type="var">l</span>); <span class="id" type="tactic">exists</span> (<a class="idref" href="arity.html#ListToCP"><span class="id" type="definition">ListToCP</span></a> (<span class="id" type="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">l</span>) <span class="id" type="var">e</span>).<br/>
<span class="id" type="tactic">split</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="tactic">simpl</span>.<br/>
<span class="id" type="tactic">split</span>; <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="CoappDup"><span class="id" type="lemma">CoappDup</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">cp</span> <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">List.NoDup</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">interp</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#CoappDupAux"><span class="id" type="lemma">CoappDupAux</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">e</span> [<span class="id" type="var">l</span> [<span class="id" type="var">m'</span> [<span class="id" type="var">cp'</span> [<span class="id" type="var">HPerm</span> [<span class="id" type="var">Hfst</span> <span class="id" type="var">Hsnd</span>]]]]]].<br/>
<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hmn</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_length"><span class="id" type="lemma">Permutation.Permutation_length</span></a> <span class="id" type="var">HPerm</span>).<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_map"><span class="id" type="lemma">Permutation.Permutation_map</span></a> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> <span class="id" type="var">interp</span> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>.<br/>
<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPOK"><span class="id" type="lemma">interp_CPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>).<br/>
<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="arity.html#lengthOfCPToList"><span class="id" type="lemma">lengthOfCPToList</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmn</span>).<br/>
<span class="id" type="tactic">do</span> 3 (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Peano.html#eq_add_S"><span class="id" type="definition">eq_add_S</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmn</span>).<br/>
<span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="Permutations.html#PermCoappOK"><span class="id" type="lemma">PermCoappOK</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">cp'</span> <span class="id" type="var">interp</span>); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HPerm</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="arity.html#app_2_n_app"><span class="id" type="lemma">app_2_n_app</span></a> <span class="id" type="keyword">with</span> (<span class="id" type="var">interp</span> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> <span class="id" type="var">cp'</span>)) (<span class="id" type="var">interp</span> (<a class="idref" href="arity.html#headCP"><span class="id" type="definition">headCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp'</span>))) (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> (<a class="idref" href="arity.html#tailCP"><span class="id" type="definition">tailCP</span></a> <span class="id" type="var">cp'</span>)) <span class="id" type="var">interp</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hsnd</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="tactics_axioms.html#coapp_bd"><span class="id" type="method">coapp_bd</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPHdOK"><span class="id" type="lemma">interp_CPHdOK</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPTlOK"><span class="id" type="lemma">interp_CPTlOK</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPHdOK"><span class="id" type="lemma">interp_CPHdOK</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPTlOK"><span class="id" type="lemma">interp_CPTlOK</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="collect_coapps"><span class="id" type="lemma">collect_coapps</span></a> : <br/>
<span class="id" type="keyword">forall</span> <span class="id" type="var">cp</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#coapp"><span class="id" type="method">coapp</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> (<a class="idref" href="sets.html#SS.add"><span class="id" type="definition">SS.add</span></a> (<a class="idref" href="CoappR.html#CPToSS"><span class="id" type="definition">CPToSS</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a>) <a class="idref" href="CoappR.html#ss"><span class="id" type="variable">ss</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">ss</span> <span class="id" type="var">interp</span> <span class="id" type="var">HCoapp</span> <span class="id" type="var">HSS</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">s</span> <span class="id" type="var">Hs</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp'</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_2"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.add_iff"><span class="id" type="lemma">SSWEqP.MP.Dec.F.add_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hs</span>.<br/>
<span class="id" type="tactic">elim</span> <span class="id" type="var">Hs</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hs</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">Hs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HDup</span> := <a class="idref" href="arity.html#NoDup_dec"><span class="id" type="lemma">NoDup_dec</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.PArith.BinPos.html#Pos.eq_dec"><span class="id" type="lemma">Pos.eq_dec</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">elim</span> <span class="id" type="var">HDup</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">HDup</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">HDup</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hincl</span> := <a class="idref" href="CoappR.html#CPToSSOK"><span class="id" type="lemma">CPToSSOK</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">cp'</span> <span class="id" type="var">s</span> <span class="id" type="var">Hs</span> <span class="id" type="var">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hlength</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp</span>)) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="arity.html#lengthOfCPToList"><span class="id" type="lemma">lengthOfCPToList</span></a>); <span class="id" type="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">HPerm</span> := <a class="idref" href="arity.html#NoDupOK"><span class="id" type="lemma">NoDupOK</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp</span>) <span class="id" type="var">Hincl</span> <span class="id" type="var">Hlength</span> <span class="id" type="var">HDup</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_map"><span class="id" type="lemma">Permutation.Permutation_map</span></a> <span class="id" type="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> <span class="id" type="var">interp</span> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>) (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="CoappR.html#interp_CPOK"><span class="id" type="lemma">interp_CPOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">HDup</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hincl</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hlength</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_sym"><span class="id" type="lemma">Permutation.Permutation_sym</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HPerm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Permutations.html#PermCoappOK"><span class="id" type="lemma">PermCoappOK</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">interp</span>); <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#CoappDup"><span class="id" type="lemma">CoappDup</span></a>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#ss_ok"><span class="id" type="definition">ss_ok</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HSS</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">HSS</span> <span class="id" type="keyword">with</span> <span class="id" type="var">s</span>; <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#SSWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">SSWEqP.MP.Dec.F.mem_1</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="collect_wds"><span class="id" type="lemma">collect_wds</span></a> : <br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">cp</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="arity.html#app"><span class="id" type="definition">app</span></a> <a class="idref" href="tactics_axioms.html#wd"><span class="id" type="method">wd</span></a> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>) -&gt;<br/>
&nbsp;&nbsp;<a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a> <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a> -&gt; <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> (<a class="idref" href="sets.html#ST.add"><span class="id" type="definition">ST.add</span></a> <a class="idref" href="CoappR.html#cp"><span class="id" type="variable">cp</span></a> <a class="idref" href="CoappR.html#st"><span class="id" type="variable">st</span></a>) <a class="idref" href="CoappR.html#interp"><span class="id" type="variable">interp</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp</span> <span class="id" type="var">st</span> <span class="id" type="var">interp</span> <span class="id" type="var">HWd</span> <span class="id" type="var">HST</span>.<br/>
<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a>.<br/>
<span class="id" type="tactic">intros</span> <span class="id" type="var">cp'</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#STWEqP.MP.Dec.F.mem_2"><span class="id" type="lemma">STWEqP.MP.Dec.F.mem_2</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#STWEqP.MP.Dec.F.add_iff"><span class="id" type="lemma">STWEqP.MP.Dec.F.add_iff</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
<span class="id" type="tactic">elim</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hmem</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">Hmem</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hcp</span> := <a class="idref" href="sets.html#PosSort.Permuted_sort"><span class="id" type="lemma">sets.PosSort.Permuted_sort</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Hcp'</span> := <a class="idref" href="sets.html#PosSort.Permuted_sort"><span class="id" type="lemma">sets.PosSort.Permuted_sort</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="sets.html#SetOfTuplesOfPositiveOrderedType.eqListOK"><span class="id" type="lemma">SetOfTuplesOfPositiveOrderedType.eqListOK</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hmem</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hmem</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hcp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Permutations.html#PermWdOK"><span class="id" type="lemma">PermWdOK</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="CoappR.html#interp_CP"><span class="id" type="definition">interp_CP</span></a> <span class="id" type="var">cp</span> <span class="id" type="var">interp</span>); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 (<span class="id" type="tactic">rewrite</span> <a class="idref" href="CoappR.html#interp_CPOK"><span class="id" type="lemma">interp_CPOK</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_map"><span class="id" type="lemma">Permutation.Permutation_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<a class="idref" href="sets.html#PosSort.sort"><span class="id" type="definition">sets.PosSort.sort</span></a> (<a class="idref" href="arity.html#CPToList"><span class="id" type="definition">CPToList</span></a> <span class="id" type="var">cp'</span>)); <span class="id" type="tactic">try</span> <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Sorting.Permutation.html#Permutation_sym"><span class="id" type="lemma">Permutation.Permutation_sym</span></a>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="CoappR.html#st_ok"><span class="id" type="definition">st_ok</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">HST</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">HST</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="CoappR.html#STWEqP.MP.Dec.F.mem_1"><span class="id" type="lemma">STWEqP.MP.Dec.F.mem_1</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="list_assoc_inv"><span class="id" type="definition">list_assoc_inv</span></a> :=<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">fix</span> <span class="id" type="var">list_assoc_inv_rec</span> (<span class="id" type="var">A</span>:<span class="id" type="keyword">Type</span>) (<span class="id" type="var">B</span>:<span class="id" type="keyword">Set</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">eq_dec</span>:<span class="id" type="keyword">forall</span> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>:<a class="idref" href="CoappR.html#B"><span class="id" type="variable">B</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">{</span></a><a class="idref" href="CoappR.html#e1"><span class="id" type="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="CoappR.html#e2"><span class="id" type="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">{</span></a><a class="idref" href="CoappR.html#e1"><span class="id" type="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">&lt;&gt;</span></a> <a class="idref" href="CoappR.html#e2"><span class="id" type="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">lst</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#prodT"><span class="id" type="abbreviation">prodT</span></a> <a class="idref" href="CoappR.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="CoappR.html#B"><span class="id" type="variable">B</span></a>)) {<span class="id" type="keyword">struct</span> <span class="id" type="var">lst</span>} : <a class="idref" href="CoappR.html#B"><span class="id" type="variable">B</span></a> -&gt; <a class="idref" href="CoappR.html#A"><span class="id" type="variable">A</span></a> -&gt; <a class="idref" href="CoappR.html#A"><span class="id" type="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> (<span class="id" type="var">key</span>:<a class="idref" href="CoappR.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">default</span>:<a class="idref" href="CoappR.html#A"><span class="id" type="variable">A</span></a>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#lst"><span class="id" type="variable">lst</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <a class="idref" href="CoappR.html#default"><span class="id" type="variable">default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> (<span class="id" type="var">pairT</span> <span class="id" type="var">v</span> <span class="id" type="var">e</span>) <span class="id" type="var">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="CoappR.html#eq_dec"><span class="id" type="variable">eq_dec</span></a> <span class="id" type="var">e</span> <a class="idref" href="CoappR.html#key"><span class="id" type="variable">key</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#left"><span class="id" type="constructor">left</span></a> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#right"><span class="id" type="constructor">right</span></a> <span class="id" type="var">_</span> =&gt; <a class="idref" href="CoappR.html#list_assoc_inv_rec"><span class="id" type="variable">list_assoc_inv_rec</span></a> <a class="idref" href="CoappR.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="CoappR.html#B"><span class="id" type="variable">B</span></a> <a class="idref" href="CoappR.html#eq_dec"><span class="id" type="variable">eq_dec</span></a> <span class="id" type="var">l</span> <a class="idref" href="CoappR.html#key"><span class="id" type="variable">key</span></a> <a class="idref" href="CoappR.html#default"><span class="id" type="variable">default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="positive_dec"><span class="id" type="lemma">positive_dec</span></a> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">p1</span> <span class="id" type="var">p2</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">{</span></a><a class="idref" href="CoappR.html#p1"><span class="id" type="variable">p1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a><a class="idref" href="CoappR.html#p2"><span class="id" type="variable">p2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}+{</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">~</span></a><a class="idref" href="CoappR.html#p1"><span class="id" type="variable">p1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a><a class="idref" href="CoappR.html#p2"><span class="id" type="variable">p2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'}'_'+'_'{'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">decide</span> <span class="id" type="var">equality</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="interp"><span class="id" type="definition">interp</span></a> (<span class="id" type="var">lvar</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a>)) (<span class="id" type="var">Default</span> : <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> -&gt; <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">p</span> =&gt; <a class="idref" href="CoappR.html#list_assoc_inv"><span class="id" type="definition">list_assoc_inv</span></a> <a class="idref" href="tactics_axioms.html#COATpoint"><span class="id" type="method">COATpoint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <a class="idref" href="CoappR.html#positive_dec"><span class="id" type="lemma">positive_dec</span></a> <a class="idref" href="CoappR.html#lvar"><span class="id" type="variable">lvar</span></a> <a class="idref" href="CoappR.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="CoappR.html#Default"><span class="id" type="variable">Default</span></a>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="CoappR.html#Coapp_refl"><span class="id" type="section">Coapp_refl</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">add_to_distinct_list</span> <span class="id" type="var">x</span> <span class="id" type="var">xs</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a>     =&gt; <span class="id" type="keyword">constr</span>:(<span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">_</span>    =&gt; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::?</span></a><span class="id" type="var">ys</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">zs</span> := <span class="id" type="var">add_to_distinct_list</span> <span class="id" type="var">x</span> <span class="id" type="var">ys</span> <span class="id" type="keyword">in</span> <span class="id" type="keyword">constr</span>:(<span class="id" type="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">zs</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">collect_points_list</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">xs</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">N</span> : <span class="id" type="var">Tpoint</span> |- <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">ys</span> := <span class="id" type="var">add_to_distinct_list</span> <span class="id" type="var">N</span> <span class="id" type="var">xs</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">collect_points_list</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>               =&gt; <span class="id" type="var">xs</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">collect_points</span> <span class="id" type="var">Tpoint</span> := <span class="id" type="var">collect_points_list</span> <span class="id" type="var">Tpoint</span> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <span class="id" type="var">Tpoint</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">number_aux</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">lvar</span> <span class="id" type="var">cpt</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">constr</span>:<span class="id" type="var">lvar</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a>          =&gt; <span class="id" type="keyword">constr</span>:(@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#prodT"><span class="id" type="abbreviation">prodT</span></a> <span class="id" type="var">Tpoint</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> ?<span class="id" type="var">H</span> ?<span class="id" type="var">T</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">scpt</span> := <span class="id" type="tactic">eval</span> <span class="id" type="keyword">vm_compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.PArith.BinPos.html#Pos.succ"><span class="id" type="definition">Pos.succ</span></a> <span class="id" type="var">cpt</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lvar2</span> := <span class="id" type="var">number_aux</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">T</span> <span class="id" type="var">scpt</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">constr</span>:(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#pairT"><span class="id" type="abbreviation">pairT</span></a>  <span class="id" type="var">Tpoint</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> <span class="id" type="var">H</span> <span class="id" type="var">cpt</span>) <span class="id" type="var">lvar2</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">number</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">lvar</span> := <span class="id" type="var">number_aux</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">lvar</span> (1%<span class="id" type="var">positive</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">build_numbered_points_list</span> <span class="id" type="var">Tpoint</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">lvar</span> := <span class="id" type="var">collect_points</span> <span class="id" type="var">Tpoint</span> <span class="id" type="keyword">in</span> <span class="id" type="var">number</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">lvar</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">List_assoc</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">elt</span> <span class="id" type="var">lst</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">constr</span>:<span class="id" type="var">lst</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#pairT"><span class="id" type="abbreviation">pairT</span></a> <span class="id" type="var">Tpoint</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#positive"><span class="id" type="inductive">positive</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) ?<span class="id" type="var">X3</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">constr</span>:(<span class="id" type="var">elt</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">X1</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="keyword">constr</span>:<span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">List_assoc</span> <span class="id" type="var">Tpoint</span> <span class="id" type="var">elt</span> <span class="id" type="var">X3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>