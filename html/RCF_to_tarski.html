<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>RCF_to_tarski</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library RCF_to_tarski</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ssreflect</span> <span class="id" type="var">ssrbool</span> <span class="id" type="var">ssrfun</span> <span class="id" type="var">ssrnat</span> <span class="id" type="var">eqtype</span> <span class="id" type="var">choice</span> <span class="id" type="var">seq</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">ssralg</span> <span class="id" type="var">ssrnum</span> <span class="id" type="var">complex</span> <span class="id" type="var">path</span>.<br/>

<br/>
<span class="id" type="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" type="keyword">Unset</span> <span class="id" type="keyword">Strict</span> <span class="id" type="keyword">Implicit</span>.<br/>
<span class="id" type="keyword">Unset</span> <span class="id" type="keyword">Printing</span> <span class="id" type="keyword">Implicit</span> <span class="id" type="var">Defensive</span>.<br/>

<br/>
<span class="id" type="keyword">Class</span> <span class="id" type="var">Tarski</span> := {<br/>
&nbsp;<span class="id" type="var">Tpoint</span> : <span class="id" type="keyword">Type</span>;<br/>
&nbsp;<span class="id" type="var">Bet</span> : <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="keyword">Prop</span>;<br/>
&nbsp;<span class="id" type="var">Cong</span> : <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="var">Tpoint</span> -&gt; <span class="id" type="keyword">Prop</span>;<br/>
&nbsp;<span class="id" type="var">between_identity</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>, <span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">A</span> -&gt; <span class="id" type="var">A</span>=<span class="id" type="var">B</span>;<br/>
&nbsp;<span class="id" type="var">cong_pseudo_reflexivity</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> : <span class="id" type="var">Tpoint</span>, <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">B</span> <span class="id" type="var">A</span>;<br/>
&nbsp;<span class="id" type="var">cong_identity</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> : <span class="id" type="var">Tpoint</span>, <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">C</span> -&gt; <span class="id" type="var">A</span> = <span class="id" type="var">B</span>;<br/>
&nbsp;<span class="id" type="var">cong_inner_transitivity</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> <span class="id" type="var">E</span> <span class="id" type="var">F</span> : <span class="id" type="var">Tpoint</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">E</span> <span class="id" type="var">F</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> <span class="id" type="var">E</span> <span class="id" type="var">F</span>;<br/>
&nbsp;<span class="id" type="var">inner_pasch</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> : <span class="id" type="var">Tpoint</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">C</span> -&gt; <span class="id" type="var">Bet</span> <span class="id" type="var">B</span> <span class="id" type="var">Q</span> <span class="id" type="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>, <span class="id" type="var">Bet</span> <span class="id" type="var">P</span> <span class="id" type="var">x</span> <span class="id" type="var">B</span> /\ <span class="id" type="var">Bet</span> <span class="id" type="var">Q</span> <span class="id" type="var">x</span> <span class="id" type="var">A</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">euclid</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">CC</span>, <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">CC</span> <span class="id" type="var">B</span> <span class="id" type="var">CC</span> /\ <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">CC</span> <span class="id" type="var">C</span> <span class="id" type="var">CC</span>;<br/>
<br/>
&nbsp;<span class="id" type="var">five_segments</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">A'</span> <span class="id" type="var">B</span> <span class="id" type="var">B'</span> <span class="id" type="var">C</span> <span class="id" type="var">C'</span> <span class="id" type="var">D</span> <span class="id" type="var">D'</span> : <span class="id" type="var">Tpoint</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">A'</span> <span class="id" type="var">B'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Cong</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">B'</span> <span class="id" type="var">C'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">D</span> <span class="id" type="var">A'</span> <span class="id" type="var">D'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Cong</span> <span class="id" type="var">B</span> <span class="id" type="var">D</span> <span class="id" type="var">B'</span> <span class="id" type="var">D'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> -&gt; <span class="id" type="var">Bet</span> <span class="id" type="var">A'</span> <span class="id" type="var">B'</span> <span class="id" type="var">C'</span> -&gt; <span class="id" type="var">A</span> &lt;&gt; <span class="id" type="var">B</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> <span class="id" type="var">C'</span> <span class="id" type="var">D'</span>;<br/>
&nbsp;<span class="id" type="var">segment_construction</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span> : <span class="id" type="var">Tpoint</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">E</span> : <span class="id" type="var">Tpoint</span>, <span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">E</span> /\ <span class="id" type="var">Cong</span> <span class="id" type="var">B</span> <span class="id" type="var">E</span> <span class="id" type="var">C</span> <span class="id" type="var">D</span>;<br/>
&nbsp;<span class="id" type="var">lower_dim</span> : <span class="id" type="tactic">exists</span> <span class="id" type="var">A</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">B</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">C</span>, ~ (<span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>);<br/>
&nbsp;<span class="id" type="var">upper_dim</span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span> : <span class="id" type="var">Tpoint</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">P</span> &lt;&gt; <span class="id" type="var">Q</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">A</span> <span class="id" type="var">P</span> <span class="id" type="var">A</span> <span class="id" type="var">Q</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">B</span> <span class="id" type="var">P</span> <span class="id" type="var">B</span> <span class="id" type="var">Q</span> -&gt; <span class="id" type="var">Cong</span> <span class="id" type="var">C</span> <span class="id" type="var">P</span> <span class="id" type="var">C</span> <span class="id" type="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">Bet</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">B</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> \/ <span class="id" type="var">Bet</span> <span class="id" type="var">C</span> <span class="id" type="var">A</span> <span class="id" type="var">B</span>)<br/>
}.<br/>

<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">GRing.Theory</span> <span class="id" type="var">Num.Theory</span>.<br/>
<span class="id" type="keyword">Local</span>&nbsp;<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">ring_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <span class="id" type="var">RcfTarski</span>.<br/>
<span class="id" type="keyword">Section</span> <span class="id" type="var">RcfTarski</span>.<br/>

<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="var">R</span> : <span class="id" type="var">rcfType</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normci</span> : `| '<span class="id" type="var">i</span> | = 1 :&gt; <span class="id" type="var">R</span>[<span class="id" type="var">i</span>].<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">expr0n</span> <span class="id" type="var">expr1n</span> <span class="id" type="var">add0r</span> <span class="id" type="var">sqrtr1</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normcMi</span> (<span class="id" type="var">x</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : `| <span class="id" type="var">x</span> * '<span class="id" type="var">i</span> | = `| <span class="id" type="var">x</span> |.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">normrM</span> <span class="id" type="var">normci</span> <span class="id" type="var">mulr1</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">normr_normalize</span> (<span class="id" type="var">x</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">x</span> != 0 -&gt; `| <span class="id" type="var">x</span> / `| <span class="id" type="var">x</span> | | = 1.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x_neq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">normrM</span> <span class="id" type="var">normfV</span> <span class="id" type="var">normr_id</span> <span class="id" type="var">mulfV</span> //= <span class="id" type="var">normr_eq0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ReM</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">Re</span> (<span class="id" type="var">a</span> * <span class="id" type="var">b</span>) = <span class="id" type="var">Re</span> <span class="id" type="var">a</span> * <span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Im</span> <span class="id" type="var">a</span> * <span class="id" type="var">Im</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">a</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">b</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ImM</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">Im</span> (<span class="id" type="var">a</span> * <span class="id" type="var">b</span>) = <span class="id" type="var">Re</span> <span class="id" type="var">a</span> * <span class="id" type="var">Im</span> <span class="id" type="var">b</span> + <span class="id" type="var">Im</span> <span class="id" type="var">a</span> * <span class="id" type="var">Re</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">a</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">b</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Re_sign</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">Re</span> ((- 1) ^+ <span class="id" type="var">n</span>) = (- 1) ^+ <span class="id" type="var">n</span> :&gt; <span class="id" type="var">R</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">elim</span>: <span class="id" type="var">n</span> =&gt; [|<span class="id" type="var">n</span> <span class="id" type="var">IHn</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">expr0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">exprS</span> <span class="id" type="var">ReM</span> !<span class="id" type="var">raddfN</span> /= <span class="id" type="var">oppr0</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span> <span class="id" type="var">IHn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Im_sign</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">Im</span> ((- 1) ^+ <span class="id" type="var">n</span>) = 0 :&gt; <span class="id" type="var">R</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">elim</span>: <span class="id" type="var">n</span> =&gt; [//|<span class="id" type="var">n</span> <span class="id" type="var">IHn</span>].<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">exprS</span> <span class="id" type="var">ImM</span> !<span class="id" type="var">raddfN</span> /= <span class="id" type="var">oppr0</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">addr0</span> <span class="id" type="var">IHn</span> <span class="id" type="var">mulr0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Re_real</span> (<span class="id" type="var">x</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">x</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> -&gt; (<span class="id" type="var">Re</span> <span class="id" type="var">x</span>)%:<span class="id" type="var">C</span> = <span class="id" type="var">x</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">x_real</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">x</span>]<span class="id" type="var">realEsign</span> // <span class="id" type="var">ReM</span> /= <span class="id" type="var">mulr0</span> <span class="id" type="var">subr0</span> <span class="id" type="var">Re_sign</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">rmorphM</span> <span class="id" type="var">rmorphX</span> <span class="id" type="var">rmorphN</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">Im_real</span> (<span class="id" type="var">x</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">x</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> -&gt; <span class="id" type="var">Im</span> <span class="id" type="var">x</span> = 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">x_real</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">x</span>]<span class="id" type="var">realEsign</span> // <span class="id" type="var">ImM</span> /= <span class="id" type="var">mulr0</span> <span class="id" type="var">add0r</span> <span class="id" type="var">Im_sign</span> <span class="id" type="var">mul0r</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">between</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := (<span class="id" type="var">b</span> == <span class="id" type="var">c</span>) || ((<span class="id" type="var">a</span> - <span class="id" type="var">b</span>) / (<span class="id" type="var">c</span> - <span class="id" type="var">b</span>) &lt;= 0).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_sym</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> = <span class="id" type="var">between</span> <span class="id" type="var">c</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span>.<br/>
<span class="id" type="var">have</span> [[-&gt;|<span class="id" type="var">bc</span>] [-&gt;|<span class="id" type="var">c_ba</span>]] //= := (<span class="id" type="var">altP</span> (<span class="id" type="var">b</span> =<span class="id" type="var">P</span> <span class="id" type="var">c</span>), <span class="id" type="var">altP</span> (<span class="id" type="var">b</span> =<span class="id" type="var">P</span> <span class="id" type="var">a</span>));<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> ?<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">lerr</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">invr_le0</span> <span class="id" type="var">invfM</span> <span class="id" type="var">invrK</span> <span class="id" type="var">mulrC</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenD</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">between</span> (<span class="id" type="var">a</span> + <span class="id" type="var">x</span>) (<span class="id" type="var">b</span> + <span class="id" type="var">x</span>) (<span class="id" type="var">c</span> + <span class="id" type="var">x</span>) = <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span> (<span class="id" type="var">inj_eq</span> (<span class="id" type="var">addIr</span> <span class="id" type="var">_</span>)).<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">do</span> !<span class="id" type="tactic">rewrite</span> ?<span class="id" type="var">opprD</span> <span class="id" type="var">addrACA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">addr0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenM</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">x</span> != 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> (<span class="id" type="var">a</span> * <span class="id" type="var">x</span>) (<span class="id" type="var">b</span> * <span class="id" type="var">x</span>) (<span class="id" type="var">c</span> * <span class="id" type="var">x</span>) = <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">x_neq0</span>; <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span> (<span class="id" type="var">inj_eq</span> (<span class="id" type="var">mulIf</span> <span class="id" type="var">x_neq0</span>)) -!<span class="id" type="var">mulrBl</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">invfM</span> <span class="id" type="var">mulrACA</span> <span class="id" type="var">divff</span> // <span class="id" type="var">mulr1</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_red0</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> = <span class="id" type="var">between</span> 0 (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) (<span class="id" type="var">c</span> - <span class="id" type="var">a</span>).<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -(<span class="id" type="var">betweenD</span> (- <span class="id" type="var">a</span>)) <span class="id" type="var">subrr</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenEacb</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> = (<span class="id" type="var">a</span> == <span class="id" type="var">b</span>) || (1 &lt;= (<span class="id" type="var">c</span> - <span class="id" type="var">a</span>) / (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">between_sym</span> /<span class="id" type="var">between</span> <span class="id" type="var">eq_sym</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ab</span>] := <span class="id" type="var">altP</span> (<span class="id" type="var">a</span> =<span class="id" type="var">P</span> <span class="id" type="var">b</span>); <span class="id" type="tactic">rewrite</span> ?(<span class="id" type="var">andbT</span>,<span class="id" type="var">andbF</span>) //=.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">c</span> <span class="id" type="keyword">as</span> <span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> - <span class="id" type="var">b</span>](<span class="id" type="var">addrNK</span> <span class="id" type="var">a</span>) -<span class="id" type="var">addrA</span> <span class="id" type="var">mulrDl</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">subr_eq0</span> //.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">oppr_ge0</span> <span class="id" type="var">opprD</span> <span class="id" type="var">subr_ge0</span> -<span class="id" type="var">mulrN</span> -<span class="id" type="var">invrN</span> <span class="id" type="var">opprB</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenEabc</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> = ((<span class="id" type="var">a</span> == <span class="id" type="var">c</span>) &amp;&amp; (<span class="id" type="var">a</span> == <span class="id" type="var">b</span>)) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" type="var">a</span> != <span class="id" type="var">c</span>) &amp;&amp; (0 &lt;= (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) / (<span class="id" type="var">c</span> - <span class="id" type="var">a</span>) &lt;= 1)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEacb</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ab</span>] := <span class="id" type="var">altP</span> (<span class="id" type="var">a</span> =<span class="id" type="var">P</span> <span class="id" type="var">b</span>); <span class="id" type="tactic">rewrite</span> ?(<span class="id" type="var">andbT</span>,<span class="id" type="var">andbF</span>) /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">lerr</span> <span class="id" type="var">ler01</span> !<span class="id" type="var">andbT</span> <span class="id" type="var">orbN</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ac</span>] //= := <span class="id" type="var">altP</span> (<span class="id" type="var">a</span> =<span class="id" type="var">P</span> <span class="id" type="var">c</span>); <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">ler10</span>.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">_</span> / <span class="id" type="var">_</span>]<span class="id" type="var">invrK</span> <span class="id" type="var">invfM</span> <span class="id" type="var">mulrC</span> <span class="id" type="var">invrK</span>; <span class="id" type="tactic">set</span> <span class="id" type="var">x</span> := <span class="id" type="var">_</span> / <span class="id" type="var">_</span>.<br/>
<span class="id" type="var">have</span> <span class="id" type="var">x_neq0</span> : <span class="id" type="var">x</span> != 0 <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_neq0</span> ?<span class="id" type="var">invr_eq0</span> // ?<span class="id" type="var">subr_eq0</span> <span class="id" type="var">eq_sym</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">xr</span>|<span class="id" type="var">xnr</span>] := <span class="id" type="var">boolP</span> (<span class="id" type="var">x</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span>); <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> (<span class="id" type="var">contraNF</span> (@<span class="id" type="var">ger1_real</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)) ?(<span class="id" type="var">contraNF</span> (@<span class="id" type="var">ger0_real</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)) ?<span class="id" type="var">rpredV</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">x_ge0</span>|<span class="id" type="var">x_lt0</span>] //= := <span class="id" type="var">real_ger0P</span> <span class="id" type="var">xr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">invf_ge1</span> // <span class="id" type="var">ltr_def</span> <span class="id" type="var">x_neq0</span> <span class="id" type="var">x_ge0</span>.<br/>
<span class="id" type="tactic">apply</span>/<span class="id" type="var">negP</span> =&gt; /(<span class="id" type="var">ler_trans</span> <span class="id" type="var">ler01</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">invr_ge0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">real_lerNgt</span> ?<span class="id" type="var">x_lt0</span> // <span class="id" type="var">real0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenEcab</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> = (<span class="id" type="var">c</span> == <span class="id" type="var">b</span>) || (1 &lt;= (<span class="id" type="var">a</span> - <span class="id" type="var">c</span>) / (<span class="id" type="var">b</span> - <span class="id" type="var">c</span>)).<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">between_sym</span> <span class="id" type="var">betweenEacb</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">cong</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := `|<span class="id" type="var">b</span> - <span class="id" type="var">a</span>| == `|<span class="id" type="var">d</span> - <span class="id" type="var">c</span>|.<br/>

<br/>
<span class="id" type="keyword">Structure</span> <span class="id" type="var">line</span> := <span class="id" type="var">Line</span> {<br/>
<span class="id" type="var">base</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>];<br/>
<span class="id" type="var">dir</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>];<br/>
<span class="id" type="var">baseP</span> : (<span class="id" type="var">Re</span> <span class="id" type="var">base</span> == 0) || (<span class="id" type="var">Im</span> <span class="id" type="var">base</span> == 0);<br/>
<span class="id" type="var">base_xoffset</span> : <span class="id" type="var">Re</span> <span class="id" type="var">dir</span> = 0 -&gt; <span class="id" type="var">Re</span> <span class="id" type="var">base</span> = 0 -&gt; <span class="id" type="var">Im</span> <span class="id" type="var">base</span> = 0;<br/>
<span class="id" type="var">base_yoffset</span> : <span class="id" type="var">Re</span> <span class="id" type="var">dir</span> != 0 -&gt; <span class="id" type="var">Im</span> <span class="id" type="var">base</span> = 0 -&gt; <span class="id" type="var">Re</span> <span class="id" type="var">base</span> = 0;<br/>
<span class="id" type="var">dir_norm_eq1</span> : `|<span class="id" type="var">dir</span>| = 1;<br/>
<span class="id" type="var">dir_Im_ge0</span> : <span class="id" type="var">Im</span> <span class="id" type="var">dir</span> &gt;= 0;<br/>
<span class="id" type="var">dir_Re_gt0</span> : <span class="id" type="var">Im</span> <span class="id" type="var">dir</span> = 0 -&gt; <span class="id" type="var">Re</span> <span class="id" type="var">dir</span> &gt; 0<br/>
}.<br/>

<br/>
<span class="id" type="keyword">Implicit</span> <span class="id" type="keyword">Types</span> <span class="id" type="var">l</span> : <span class="id" type="var">line</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">base_line_of</span> (<span class="id" type="var">a</span> <span class="id" type="var">v</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="keyword">if</span> <span class="id" type="var">Re</span> <span class="id" type="var">v</span> != 0 <span class="id" type="keyword">then</span> <span class="id" type="var">a</span> - (<span class="id" type="var">Re</span> <span class="id" type="var">a</span> / <span class="id" type="var">Re</span> <span class="id" type="var">v</span>)%:<span class="id" type="var">C</span> * <span class="id" type="var">v</span><br/>
<span class="id" type="keyword">else</span> <span class="id" type="keyword">if</span> <span class="id" type="var">Im</span> <span class="id" type="var">v</span> != 0 <span class="id" type="keyword">then</span> <span class="id" type="var">a</span> - (<span class="id" type="var">Im</span> <span class="id" type="var">a</span> / <span class="id" type="var">Im</span> <span class="id" type="var">v</span>)%:<span class="id" type="var">C</span> * <span class="id" type="var">v</span><br/>
<span class="id" type="keyword">else</span> 0 + '<span class="id" type="var">i</span> * (<span class="id" type="var">Im</span> <span class="id" type="var">a</span>)%:<span class="id" type="var">C</span>.<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">base_line_ofP</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;(<span class="id" type="var">Re</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) == 0) || (<span class="id" type="var">Im</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) == 0).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">X</span> == <span class="id" type="var">_</span>) || <span class="id" type="var">_</span>]<span class="id" type="var">fun_if</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> || (<span class="id" type="var">X</span> == <span class="id" type="var">_</span>)]<span class="id" type="var">fun_if</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">raddfB</span> <span class="id" type="var">raddfD</span> /=.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">v</span> =&gt; <span class="id" type="var">x</span> <span class="id" type="var">y</span> /=; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">x</span> =<span class="id" type="var">P</span> 0)) =&gt; /= [-&gt;|<span class="id" type="var">x_neq0</span>]; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulfVK</span> // <span class="id" type="var">subrr</span> <span class="id" type="var">eqxx</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulr0</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">y</span> =<span class="id" type="var">P</span> 0)) =&gt; /= [|<span class="id" type="var">y_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqxx</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulfVK</span> // !<span class="id" type="var">raddfD</span> /= <span class="id" type="var">subrr</span> <span class="id" type="var">eqxx</span> <span class="id" type="var">orbT</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">dir_of</span> (<span class="id" type="var">v</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) :=<br/>
<span class="id" type="keyword">if</span> <span class="id" type="var">v</span> == 0 <span class="id" type="keyword">then</span> 1<br/>
<span class="id" type="keyword">else</span> (-1) ^+ ((<span class="id" type="var">Im</span> <span class="id" type="var">v</span> &lt; 0) || ((<span class="id" type="var">Im</span> <span class="id" type="var">v</span> == 0) &amp;&amp; (<span class="id" type="var">Re</span> <span class="id" type="var">v</span> &lt; 0))) * (<span class="id" type="var">v</span> / `|<span class="id" type="var">v</span>|).<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">dir_of_norm_eq1</span> <span class="id" type="var">v</span> : `|<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>| = 1.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">_</span>|<span class="id" type="var">v_neq0</span>]; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">normr1</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">normrM</span> <span class="id" type="var">normr_sign</span> <span class="id" type="var">mul1r</span> <span class="id" type="var">normr_normalize</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">collinear_dir_of</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">exists2</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> &amp; <span class="id" type="var">k</span> * <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span> = <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">exists</span> (<span class="id" type="var">v</span> / <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>); <span class="id" type="tactic">rewrite</span> ?<span class="id" type="var">mulfVK</span> //; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">normr_eq0</span> <span class="id" type="var">dir_of_norm_eq1</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [-&gt;|<span class="id" type="var">v_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">real0</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">invfM</span> !<span class="id" type="var">mulrA</span> -<span class="id" type="var">mulrA</span> <span class="id" type="var">mulrACA</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mul1r</span> <span class="id" type="var">realM</span> //.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">realV</span> <span class="id" type="var">realX</span> ?<span class="id" type="var">realN</span> ?<span class="id" type="var">real1</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">realV</span> <span class="id" type="var">normr_real</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">dir_ofP</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">v</span> != 0 -&gt; <span class="id" type="var">exists2</span> <span class="id" type="var">k</span>, (<span class="id" type="var">k</span> != 0) &amp;&amp; (<span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span>) &amp; <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span> = <span class="id" type="var">k</span> * <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k</span> <span class="id" type="var">k_real</span> {1 3}&lt;-] := <span class="id" type="var">collinear_dir_of</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_eq0</span> <span class="id" type="var">negb_or</span> =&gt; /<span class="id" type="var">andP</span> [<span class="id" type="var">k_neq0</span> <span class="id" type="var">_</span>].<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">exists</span> <span class="id" type="var">k</span>^-1; <span class="id" type="tactic">rewrite</span> ?<span class="id" type="var">invr_eq0</span> ?<span class="id" type="var">k_neq0</span> ?<span class="id" type="var">realV</span> ?<span class="id" type="var">mulKf</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ReIm_dir_of_eq0</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">v</span> != 0 -&gt; <br/>
&nbsp;&nbsp;((<span class="id" type="var">Re</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) == 0) = (<span class="id" type="var">Re</span> <span class="id" type="var">v</span> == 0))<br/>
* ((<span class="id" type="var">Im</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) == 0) = (<span class="id" type="var">Im</span> <span class="id" type="var">v</span> == 0)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">v_neq0</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k</span> /<span class="id" type="var">andP</span> [<span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>] -&gt;] := <span class="id" type="var">dir_ofP</span> <span class="id" type="var">v_neq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ReM</span> <span class="id" type="var">ImM</span> <span class="id" type="var">Im_real</span> // !<span class="id" type="var">mul0r</span> <span class="id" type="var">oppr0</span> !<span class="id" type="var">addr0</span> !<span class="id" type="var">mulf_eq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">k</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]).<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> == 0]<span class="id" type="var">Re_real</span> // (<span class="id" type="var">negPf</span> <span class="id" type="var">k_neq0</span>).<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">base_line_of_xoffset</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">Re</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) = 0 -&gt; <span class="id" type="var">Re</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) = 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">Im</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) = 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">v_neq0</span>] := <span class="id" type="var">eqVneq</span> <span class="id" type="var">v</span> 0.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span> /= <span class="id" type="var">eqxx</span> =&gt; <span class="id" type="var">Re_1_eq0</span>. <span class="id" type="tactic">move</span>: <span class="id" type="var">Re_sign</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">O</span>) <span class="id" type="var">Re_1_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_1_eq1</span>; <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">expr0</span> <span class="id" type="var">Re_1_eq0</span>{<span class="id" type="var">Re_1_eq0</span>}; <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">eq01</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">Num.Internals.ltr01</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">R</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq01</span> <span class="id" type="var">ltrr</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_v_eq0</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">Re_v_eq0</span>;<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ReIm_dir_of_eq0</span> // =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_v_eq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_v_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">rewrite</span> /=; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0))=&gt; [<span class="id" type="var">Im_v_eq0</span>|<span class="id" type="var">Im_v_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">v_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> != 0]<span class="id" type="var">complexE</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">Im_v_eq0</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">addr0</span>; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">rewrite</span>  [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> * <span class="id" type="var">X</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">add0r</span> /= !<span class="id" type="var">raddfB</span> /= !<span class="id" type="var">mul0r</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">subr0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">add0r</span> <span class="id" type="var">addr0</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">mul1r</span> <span class="id" type="var">mulfVK</span> ?<span class="id" type="var">subrr</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">base_line_of_yoffset</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">Re</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) != 0 -&gt; <span class="id" type="var">Im</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) = 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">Re</span> (<span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) = 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">v_neq0</span>] := <span class="id" type="var">eqVneq</span> <span class="id" type="var">v</span> 0.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> <span class="id" type="var">eqxx</span> /= !<span class="id" type="var">mul0r</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">subr0</span> <span class="id" type="var">addr0</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> <span class="id" type="var">ReIm_dir_of_eq0</span> // =&gt; <span class="id" type="var">Re_v_neq0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_v_neq0</span> !<span class="id" type="var">raddfB</span> /= <span class="id" type="var">ReM</span> <span class="id" type="var">ImM</span> /= !<span class="id" type="var">mul0r</span> <span class="id" type="var">oppr0</span> !<span class="id" type="var">addr0</span> <span class="id" type="var">mulfVK</span> ?<span class="id" type="var">subrr</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">dir_of_norm_im_geq0</span> <span class="id" type="var">v</span> : <span class="id" type="var">Im</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) &gt;= 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [//|<span class="id" type="var">v_neq0</span>].<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ImM</span> <span class="id" type="var">Re_sign</span> <span class="id" type="var">Im_sign</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">addr0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ImM</span> [<span class="id" type="var">Im</span> (<span class="id" type="var">_</span> ^-1)]<span class="id" type="var">Im_real</span> ?<span class="id" type="var">realV</span> ?<span class="id" type="var">normr_real</span> //.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">add0r</span> <span class="id" type="var">mulrA</span> <span class="id" type="var">mulr_ge0</span> //; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">ler0c</span> <span class="id" type="var">Re_real</span> ?<span class="id" type="var">invr_ge0</span> ?<span class="id" type="var">realV</span> ?<span class="id" type="var">normr_real</span>.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">sgrP</span> =&gt; /= <span class="id" type="var">Im_v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_v</span> <span class="id" type="var">mulr0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">expr0</span> <span class="id" type="var">mul1r</span> <span class="id" type="var">le0r</span> <span class="id" type="var">Im_v</span> <span class="id" type="var">orbT</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">expr1</span> <span class="id" type="var">le0r</span> <span class="id" type="var">nmulr_lgt0</span> ?<span class="id" type="var">ltrN10</span> ?<span class="id" type="var">orbT</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fact</span> <span class="id" type="var">dir_of_im_eq0_re_gt0</span> <span class="id" type="var">v</span> : <span class="id" type="var">Im</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) = 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Re</span> (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>) &gt; 0.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">_</span> <span class="id" type="var">_</span> /=|<span class="id" type="var">v_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ltr01</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ImM</span> <span class="id" type="var">Re_sign</span> <span class="id" type="var">Im_sign</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">addr0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ImM</span> [<span class="id" type="var">Im</span> (<span class="id" type="var">_</span> ^-1)]<span class="id" type="var">Im_real</span> ?<span class="id" type="var">realV</span> ?<span class="id" type="var">normr_real</span> //.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">add0r</span> <span class="id" type="var">mulrA</span> =&gt; /<span class="id" type="var">eqP</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_eq0</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">_</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]).<br/>
<span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> == 0]<span class="id" type="var">Re_real</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">realV</span> <span class="id" type="var">normr_real</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">invr_eq0</span> <span class="id" type="var">normr_eq0</span> (<span class="id" type="var">negPf</span> <span class="id" type="var">v_neq0</span>) <span class="id" type="var">orbF</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_eq0</span> <span class="id" type="var">signr_eq0</span> /= =&gt; /<span class="id" type="var">eqP</span> <span class="id" type="var">Im_v_eq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_v_eq0</span> ; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ltrr</span> /= <span class="id" type="var">ReM</span> <span class="id" type="var">Im_sign</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span> <span class="id" type="var">Re_sign</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ReM</span> <span class="id" type="var">Im_v_eq0</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span> <span class="id" type="var">mulrA</span> <span class="id" type="var">mulr_gt0</span> //; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">ltcR</span> <span class="id" type="var">Re_real</span> ?<span class="id" type="var">realV</span> ?<span class="id" type="var">normr_real</span> // <span class="id" type="var">invr_gt0</span> <span class="id" type="var">normr_gt0</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">sgrP</span> (<span class="id" type="var">Re</span> <span class="id" type="var">v</span>)); <span class="id" type="tactic">rewrite</span> ?<span class="id" type="var">mul1r</span> ?<span class="id" type="var">mulN1r</span> ?<span class="id" type="var">oppr_gt0</span> // =&gt; <span class="id" type="var">Re_v_eq0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">case</span>: <span class="id" type="var">v</span> <span class="id" type="var">Im_v_eq0</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">v_neq0</span> =&gt; /= ? ? -&gt; -&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqxx</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">line_of</span> (<span class="id" type="var">a</span> <span class="id" type="var">v</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="var">Line</span> (<span class="id" type="var">base_line_ofP</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) <br/>
&nbsp;&nbsp;(@<span class="id" type="var">base_line_of_xoffset</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) (@<span class="id" type="var">base_line_of_yoffset</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>) (<span class="id" type="var">dir_of_norm_eq1</span> <span class="id" type="var">v</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="var">dir_of_norm_im_geq0</span> <span class="id" type="var">v</span>) (@<span class="id" type="var">dir_of_im_eq0_re_gt0</span> <span class="id" type="var">v</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">is_on_line</span> (<span class="id" type="var">l</span> : <span class="id" type="var">line</span>) (<span class="id" type="var">p</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <br/>
&nbsp;&nbsp;(<span class="id" type="var">base_line_of</span> <span class="id" type="var">p</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)) == <span class="id" type="var">base</span> <span class="id" type="var">l</span>.<br/>

<br/>
<span class="id" type="keyword">Canonical</span> <span class="id" type="var">line_of_predType</span> := <span class="id" type="keyword">Eval</span> <span class="id" type="tactic">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">mkPredType</span> <span class="id" type="var">is_on_line</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_base</span> <span class="id" type="var">l</span> : <span class="id" type="var">base</span> <span class="id" type="var">l</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">topredE</span> /= /<span class="id" type="var">is_on_line</span>.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">l</span> =&gt; /= <span class="id" type="var">a</span> <span class="id" type="var">v</span> <span class="id" type="var">a_cross</span> <span class="id" type="var">a_xoffset</span> <span class="id" type="var">a_yoffset</span> <span class="id" type="var">_</span> <span class="id" type="var">Re_v_gt0</span>; <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">a_yoffset</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>) =&gt; /=; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">_</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">a_cross</span> =&gt; /<span class="id" type="var">orP</span> [/<span class="id" type="var">eqP</span> -&gt;|/<span class="id" type="var">eqP</span> -&gt; -&gt;] //;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">rv0</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) <span class="id" type="var">rv0</span> <span class="id" type="var">Re_v_gt0</span> =&gt; [-&gt; -&gt;|] //=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span> /(<span class="id" type="var">_</span> <span class="id" type="var">erefl</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ltrr</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Im_v_neq0</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> {2}[<span class="id" type="var">v</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">add0r</span>.<br/>
<span class="id" type="var">have</span>: (<span class="id" type="var">Im</span> <span class="id" type="var">a</span> = 0). <span class="id" type="tactic">case</span>: (<span class="id" type="var">orP</span> <span class="id" type="var">a_cross</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_a_eq0</span>; <span class="id" type="tactic">move</span>: (<span class="id" type="var">a_xoffset</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">Re_a_eq0</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_a_eq0</span> //.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span> -&gt;; <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_something</span> <span class="id" type="var">p</span> <span class="id" type="var">l</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span> -&gt; <span class="id" type="var">exists2</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> &amp; <span class="id" type="var">p</span> = <span class="id" type="var">base</span> <span class="id" type="var">l</span> + <span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">topredE</span> /= /<span class="id" type="var">is_on_line</span> /<span class="id" type="var">base_line_of</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_Re_eq0</span>|<span class="id" type="var">dir_Re_neq0</span>] /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_dir_eq0</span>|<span class="id" type="var">Im_dir_neq0</span>] /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">dir_Re_eq0</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">exists</span> (<span class="id" type="var">Im</span> <span class="id" type="var">p</span> / <span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>))%:<span class="id" type="var">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">admit</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">eq</span>{<span class="id" type="var">eq</span>} -<span class="id" type="var">opprB</span> <span class="id" type="var">addrC</span> -<span class="id" type="var">mulN1r</span> <span class="id" type="var">mulrBr</span> <span class="id" type="var">mulN1r</span> <span class="id" type="var">addrA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">add0r</span> -<span class="id" type="var">mulN1r</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">exists</span> (<span class="id" type="var">Re</span> <span class="id" type="var">p</span> / <span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>))%:<span class="id" type="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">admit</span>.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">eq</span>{<span class="id" type="var">eq</span>} -<span class="id" type="var">opprB</span> <span class="id" type="var">addrC</span> -<span class="id" type="var">mulN1r</span> <span class="id" type="var">mulrBr</span> <span class="id" type="var">mulN1r</span> <span class="id" type="var">addrA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">add0r</span> -<span class="id" type="var">mulN1r</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_something_bis</span> <span class="id" type="var">p</span> <span class="id" type="var">l</span> :<br/>
&nbsp;&nbsp;(<span class="id" type="var">exists2</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> &amp; <span class="id" type="var">p</span> = <span class="id" type="var">base</span> <span class="id" type="var">l</span> + <span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>) -&gt; <span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">k</span> <span class="id" type="var">k_real</span> <span class="id" type="var">k_eq</span>]; <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">topredE</span> /= /<span class="id" type="var">is_on_line</span> /<span class="id" type="var">base_line_of</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_Re_eq0</span>|<span class="id" type="var">dir_Re_neq0</span>] /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_dir_eq0</span>|<span class="id" type="var">Im_dir_neq0</span>] /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">dir_Re_eq0</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq</span>; <span class="id" type="tactic">move</span>: (<span class="id" type="var">baseP</span> <span class="id" type="var">l</span>) (<span class="id" type="var">base_xoffset</span> <span class="id" type="var">dir_Re_eq0</span>) =&gt;/<span class="id" type="var">orP</span> <span class="id" type="var">baseP</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: <span class="id" type="var">baseP</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">baseP</span> =&gt; [<span class="id" type="var">Im_base_eq0</span>|<span class="id" type="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> [<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">baseP</span> (<span class="id" type="var">Im_base_eq0</span> <span class="id" type="var">baseP</span>); <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -{2}<span class="id" type="var">Re_k</span> <span class="id" type="var">ImM</span>; <span class="id" type="var">simpc</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_k</span> -{2}[<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">mul1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mulr1</span> <span class="id" type="var">divr1</span> <span class="id" type="var">Re_k</span> <span class="id" type="var">subrr</span>.<br/>

<br/>
<span class="id" type="var">have</span>:  (<span class="id" type="var">Im</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span> + <span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>) = <span class="id" type="var">Im</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span>) + <span class="id" type="var">Im</span> (<span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="var">admit</span>.<br/>

<br/>
<span class="id" type="tactic">move</span>=&gt; -&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">baseP</span> -<span class="id" type="var">Re_k</span> <span class="id" type="var">ImM</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_k</span> -{2}[<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">mul1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mulr1</span> <span class="id" type="var">divr1</span> <span class="id" type="var">Re_k</span> -<span class="id" type="var">addrA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">addr0</span>.<br/>

<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq</span>.<br/>

<br/>
<span class="id" type="var">have</span>:  (<span class="id" type="var">Re</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span> + <span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>) = <span class="id" type="var">Re</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span>) + <span class="id" type="var">Re</span> (<span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="var">admit</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; -&gt;.<br/>

<br/>
<span class="id" type="tactic">move</span>: (<span class="id" type="var">baseP</span> <span class="id" type="var">l</span>) (<span class="id" type="var">base_yoffset</span> <span class="id" type="var">dir_Re_neq0</span>) =&gt;/<span class="id" type="var">orP</span> <span class="id" type="var">baseP</span>.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">baseP</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">baseP</span>.<br/>

<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">baseP</span>; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">rewrite</span> -{2}<span class="id" type="var">Re_k</span> <span class="id" type="var">ReM</span>; <span class="id" type="var">simpc</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_k</span> -{2}[<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mulr1</span> <span class="id" type="var">divr1</span> <span class="id" type="var">Re_k</span> -<span class="id" type="var">addrA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">addr0</span>.<br/>

<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Re_base_eq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">baseP</span> (<span class="id" type="var">Re_base_eq0</span> <span class="id" type="var">baseP</span>); <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">rewrite</span> -{2}<span class="id" type="var">Re_k</span> <span class="id" type="var">ReM</span>; <span class="id" type="var">simpc</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_k</span> -{2}[<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mulr1</span> <span class="id" type="var">divr1</span> <span class="id" type="var">Re_k</span> <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_something_summary</span>  <span class="id" type="var">p</span> <span class="id" type="var">l</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span> &lt;-&gt; <span class="id" type="var">exists2</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> &amp; <span class="id" type="var">p</span> = <span class="id" type="var">base</span> <span class="id" type="var">l</span> + <span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">mem_something</span>.<br/>
<span class="id" type="tactic">apply</span> <span class="id" type="var">mem_something_bis</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">base_something</span> <span class="id" type="var">l</span> : <span class="id" type="var">base</span> <span class="id" type="var">l</span> = <span class="id" type="var">base_line_of</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span>) (<span class="id" type="var">dir_of</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> {1 2 4}[<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">move</span>: (<span class="id" type="var">dir_ofP</span> <span class="id" type="var">dir_neq0</span>) =&gt; [<span class="id" type="var">k</span> <span class="id" type="var">kP</span> -&gt;]; <span class="id" type="tactic">move</span>: <span class="id" type="var">kP</span>; <span class="id" type="tactic">case</span>/<span class="id" type="var">andP</span> =&gt; <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>; <span class="id" type="var">have</span>[<span class="id" type="var">Re_k_neq0</span>]: (<span class="id" type="var">Re</span> <span class="id" type="var">k</span> != 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">_</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]) /= <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">ReM</span> <span class="id" type="var">ImM</span> -<span class="id" type="var">Re_k</span> {5 10}[<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span> <span class="id" type="var">Re_k</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Re_dir_eq0</span>|<span class="id" type="var">Re_dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_dir_eq0</span>|<span class="id" type="var">Im_dir_neq0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> /= <span class="id" type="var">mulfVK</span> <span class="id" type="var">mulf_neq0</span> // <span class="id" type="var">subrr</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">subr0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">baseP</span> <span class="id" type="var">l</span>) (<span class="id" type="var">base_xoffset</span> <span class="id" type="var">Re_dir_eq0</span>); <span class="id" type="tactic">case</span>/<span class="id" type="var">orP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_base_eq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_base_eq0</span> =&gt; -&gt;.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_base_eq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_base_eq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulfVK</span> <span class="id" type="var">mulf_neq0</span> // <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="tactic">move</span>: (<span class="id" type="var">baseP</span> <span class="id" type="var">l</span>) (<span class="id" type="var">base_yoffset</span> <span class="id" type="var">Re_dir_neq0</span>); <span class="id" type="tactic">case</span>/<span class="id" type="var">orP</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_dir_eq0</span> !<span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span>.<br/>
<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_dir_eq0</span> <span class="id" type="var">sub0r</span> =&gt; <span class="id" type="var">Re_dir_eq0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_dir_eq0</span> // !<span class="id" type="var">mul0r</span> <span class="id" type="var">oppr0</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">dir_of_something</span> <span class="id" type="var">l</span> : <span class="id" type="var">dir</span> <span class="id" type="var">l</span> = <span class="id" type="var">dir_of</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> (<span class="id" type="var">dir_norm_eq1</span> <span class="id" type="var">l</span>) <span class="id" type="var">divr1</span>; <span class="id" type="tactic">move</span>: (<span class="id" type="var">dir_Im_ge0</span> <span class="id" type="var">l</span>); <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ler_eqVlt</span>.<br/>
<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">orP</span> <span class="id" type="var">dir_Im_ge0</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">dir_Im_ge0</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">dir_Im_gt0</span>; <span class="id" type="tactic">move</span>: (<span class="id" type="var">gtr_eqF</span> <span class="id" type="var">dir_Im_gt0</span>) =&gt; -&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">ltr_gtF</span> //=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">expr0</span> <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">dir_Im_eq0</span>; <span class="id" type="tactic">move</span>: (<span class="id" type="var">dir_Re_gt0</span> <span class="id" type="var">dir_Im_eq0</span>) =&gt; <span class="id" type="var">dir_Re_gt0</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_Im_eq0</span> <span class="id" type="var">eqxx</span> <span class="id" type="var">ltrr</span> <span class="id" type="var">ltr_gtF</span> // <span class="id" type="var">expr0</span> <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">Mconj</span> (<span class="id" type="var">b</span> : <span class="id" type="var">bool</span>) (<span class="id" type="var">z</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="keyword">if</span> <span class="id" type="var">b</span> <span class="id" type="keyword">then</span> <span class="id" type="var">z</span>^* <span class="id" type="keyword">else</span> <span class="id" type="var">z</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">Mconj_of_line</span> (<span class="id" type="var">b</span> : <span class="id" type="var">bool</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">line</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">line_of</span> (<span class="id" type="var">Mconj</span> <span class="id" type="var">b</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span>)) (<span class="id" type="var">Mconj</span> <span class="id" type="var">b</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">translation</span> (<span class="id" type="var">vt</span> <span class="id" type="var">v</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="var">vt</span> + <span class="id" type="var">v</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">translation_of_line</span> (<span class="id" type="var">vt</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) (<span class="id" type="var">l</span> : <span class="id" type="var">line</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">line_of</span> (<span class="id" type="var">translation</span> <span class="id" type="var">vt</span> (<span class="id" type="var">base</span> <span class="id" type="var">l</span>)) (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <span class="id" type="var">complex_real</span> (<span class="id" type="var">x</span> : <span class="id" type="var">R</span>) : <span class="id" type="var">x</span>%:<span class="id" type="var">C</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">Num.real</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">lineTranslationEq</span> <span class="id" type="var">vt</span> <span class="id" type="var">p</span> <span class="id" type="var">l</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span> &lt;-&gt; <span class="id" type="var">translation</span> <span class="id" type="var">vt</span> <span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">translation_of_line</span> <span class="id" type="var">vt</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mem_something_summary</span> /<span class="id" type="var">translation_of_line</span> /<span class="id" type="var">line_of</span> /=.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">dir_of_something</span> /<span class="id" type="var">translation</span> /<span class="id" type="var">base_line_of</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Re_dir_eq0</span>|<span class="id" type="var">Re_dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_dir_eq0</span>|<span class="id" type="var">Im_dir_neq0</span> /=].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: (<span class="id" type="var">baseP</span> <span class="id" type="var">l</span>) (<span class="id" type="var">base_xoffset</span> <span class="id" type="var">Re_dir_eq0</span>) =&gt;/<span class="id" type="var">orP</span> <span class="id" type="var">baseP</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">baseP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_base_eq0</span> <span class="id" type="var">Im_base_eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> [<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> {3}[<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">Re_base_eq0</span> (<span class="id" type="var">Im_base_eq0</span> <span class="id" type="var">Re_base_eq0</span>); <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -{2}[<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">divr1</span> <span class="id" type="var">mulf_div</span> <span class="id" type="var">mulr1</span> -{2}[<span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)]<span class="id" type="var">mul1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mulr1</span> <span class="id" type="var">divr1</span> [<span class="id" type="var">dir</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_dir_eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpc</span>; <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">k</span> <span class="id" type="var">k_real</span> <span class="id" type="var">k_eq</span>]; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq</span>{<span class="id" type="var">k_eq</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> (<span class="id" type="var">k</span> + (<span class="id" type="var">Im</span> <span class="id" type="var">vt</span> / <span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>))%:<span class="id" type="var">C</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">realD</span> ?<span class="id" type="var">complex_real</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrDl</span>; <span class="id" type="var">simpc</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulfVK</span> // [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + <span class="id" type="var">X</span>]<span class="id" type="var">addrC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + <span class="id" type="var">X</span>]<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + (<span class="id" type="var">X</span> + <span class="id" type="var">_</span>)]<span class="id" type="var">addrC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">add0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; [<span class="id" type="var">k</span> <span class="id" type="var">k_real</span> <span class="id" type="var">k_eq</span>]; <span class="id" type="tactic">move</span>: <span class="id" type="var">k_eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">addrC</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">k_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">k_eq</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> -<span class="id" type="var">subr_eq</span> <span class="id" type="var">addrC</span> <span class="id" type="var">addrA</span>.<br/>
<span class="id" type="keyword">Search</span> (<span class="id" type="var">_</span>) (<span class="id" type="var">_</span> + <span class="id" type="var">_</span>) (<span class="id" type="var">_</span> = <span class="id" type="var">_</span>).<br/>
&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq</span>{<span class="id" type="var">k_eq</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> (<span class="id" type="var">k</span> + (<span class="id" type="var">Im</span> <span class="id" type="var">vt</span> / <span class="id" type="var">Im</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>))%:<span class="id" type="var">C</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">realD</span> //.<br/>

<br/>
&nbsp;<span class="id" type="var">admit</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrDl</span>; <span class="id" type="var">simpc</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulfVK</span> // [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + <span class="id" type="var">X</span>]<span class="id" type="var">addrC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + <span class="id" type="var">X</span>]<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> = <span class="id" type="var">_</span> + (<span class="id" type="var">X</span> + <span class="id" type="var">_</span>)]<span class="id" type="var">addrC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">add0r</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Search</span> (<span class="id" type="var">_</span>) (<span class="id" type="var">_</span> + <span class="id" type="var">_</span>) <span class="id" type="var">Num.real</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">homothery_and_rotation_of_line</span> (<span class="id" type="var">k</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) (<span class="id" type="var">l</span> : <span class="id" type="var">line</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">line_of</span> (<span class="id" type="var">k</span> * <span class="id" type="var">base</span> <span class="id" type="var">l</span>) (<span class="id" type="var">k</span> * <span class="id" type="var">dir</span> <span class="id" type="var">l</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">base_line_of_something</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span> <span class="id" type="var">k</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">k</span> != 0 -&gt; <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> -&gt; <span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span> = <span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> (<span class="id" type="var">k</span> * <span class="id" type="var">v</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>; <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="var">have</span> <span class="id" type="var">Re_k_neq0</span>: (<span class="id" type="var">Re</span> <span class="id" type="var">k</span> != 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">_</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]) /= <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">Re_k</span> <span class="id" type="var">ReM</span> <span class="id" type="var">ImM</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> {1 2 4 5}<span class="id" type="var">Re_k</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">k_real</span> <span class="id" type="var">Re_k</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="tactic">rewrite</span> {3 6 9 12}[<span class="id" type="var">v</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [-&gt; /=|<span class="id" type="var">v_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> /=.<br/>
<span class="id" type="var">have</span>[-&gt; /=|<span class="id" type="var">Re_v_neq0</span>]:= <span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> /=; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [-&gt; /=|<span class="id" type="var">Im_v_neq0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_neq0</span> //= !<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">mulf_neq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_neq0</span> //= !<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">mulf_neq0</span> //.<br/>
<span class="id" type="tactic">rewrite</span>  -[<span class="id" type="var">Re</span> <span class="id" type="var">k</span> * <span class="id" type="var">Im</span> <span class="id" type="var">v</span>]<span class="id" type="var">divr1</span> -{1}[<span class="id" type="var">Im</span> <span class="id" type="var">v</span>]<span class="id" type="var">divr1</span> !<span class="id" type="var">mulf_div</span> !<span class="id" type="var">mulr1</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrCA</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">collinear_dir_of_Mconj_aux</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> /\ <span class="id" type="var">k</span> * <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span> = <span class="id" type="var">v</span> /\ (<span class="id" type="var">k</span> * <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>)^* = <span class="id" type="var">v</span>^*.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k1</span> <span class="id" type="var">k1_real</span> <span class="id" type="var">col_dir1</span>] := <span class="id" type="var">collinear_dir_of</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k2</span> <span class="id" type="var">k2_real</span> <span class="id" type="var">col_dir2</span>] := <span class="id" type="var">collinear_dir_of</span> <span class="id" type="var">v</span>^*.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">exists</span> <span class="id" type="var">k1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">k1_real</span> <span class="id" type="var">col_dir1</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">collinear_dir_of_Mconj</span> <span class="id" type="var">v</span> :<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">k</span>, <span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> /\ <span class="id" type="var">k</span> * <span class="id" type="var">dir_of</span> <span class="id" type="var">v</span> = <span class="id" type="var">v</span> /\ <span class="id" type="var">k</span> * (<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>)^* = <span class="id" type="var">v</span>^*.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k</span> <span class="id" type="var">kP</span>] := <span class="id" type="var">collinear_dir_of_Mconj_aux</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">k_real</span> <span class="id" type="var">kP</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">col_dir1</span> <span class="id" type="var">col_dir2</span>.<br/>
<span class="id" type="tactic">exists</span> <span class="id" type="var">k</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_real</span> <span class="id" type="var">col_dir1</span>; <span class="id" type="tactic">split</span> =&gt; //; <span class="id" type="tactic">split</span> =&gt; //.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">col_dir2</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>; <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">Re_k</span>{<span class="id" type="var">Re_k</span>}.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">dir_of</span> <span class="id" type="var">v</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">lineMconjEq</span> <span class="id" type="var">b</span> <span class="id" type="var">p</span> <span class="id" type="var">l</span> : <span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">l</span> &lt;-&gt; <span class="id" type="var">Mconj</span> <span class="id" type="var">b</span> <span class="id" type="var">p</span> \<span class="id" type="keyword">in</span> <span class="id" type="var">Mconj_of_line</span> <span class="id" type="var">b</span> <span class="id" type="var">l</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> -!<span class="id" type="var">topredE</span> /= /<span class="id" type="var">Mconj_of_line</span> /<span class="id" type="var">Mconj</span> /<span class="id" type="var">is_on_line</span> /<span class="id" type="var">line_of</span> /=.<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">b</span>; <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">have</span> [<span class="id" type="var">k</span> <span class="id" type="var">k_real</span> <span class="id" type="var">col_dir</span>] := <span class="id" type="var">collinear_dir_of</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> -{1 3}<span class="id" type="var">col_dir</span>. <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">k</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">k_eq0</span>|<span class="id" type="var">k_neq0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">col_dir</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq0</span> <span class="id" type="var">mul0r</span>; <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">dir_eq0</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">dir_eq0</span> <span class="id" type="var">eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -!<span class="id" type="var">base_line_of_something</span> // -<span class="id" type="var">base_something</span>.<br/>

<br/>
<span class="id" type="var">have</span> [<span class="id" type="var">k</span> <span class="id" type="var">kP</span>] := (<span class="id" type="var">collinear_dir_of_Mconj</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>)).<br/>
<span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">k_real</span> <span class="id" type="var">kP</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">col_dir1</span> <span class="id" type="var">col_dir2</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">dir_eq0</span>|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">dir_norm_eq1</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_norm_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">normr0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">k</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">k_eq0</span>|<span class="id" type="var">k_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">col_dir1</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">k_eq0</span> <span class="id" type="var">mul0r</span>; <span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">dir_eq0</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> <span class="id" type="var">eqxx</span>.<br/>
<span class="id" type="tactic">rewrite</span> -{1}<span class="id" type="var">col_dir1</span>{<span class="id" type="var">col_dir1</span>} -{2}<span class="id" type="var">col_dir2</span>{<span class="id" type="var">col_dir2</span>}.<br/>
<span class="id" type="tactic">rewrite</span> -!<span class="id" type="var">base_line_of_something</span> // {1}<span class="id" type="var">base_something</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">k</span> <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>; <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">dir_of_something</span>.<br/>

<br/>
; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">dir</span> <span class="id" type="var">l</span>) =<span class="id" type="var">P</span> 0)); <span class="id" type="var">last</span> <span class="id" type="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Re_dir_meq0</span>; <span class="id" type="tactic">rewrite</span> /=.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">dir_eq0</span> /<span class="id" type="var">base_line_of</span> {6}[<span class="id" type="var">p</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">divr1</span> <span class="id" type="var">subrr</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">neqr_lt</span> <span class="id" type="var">ltr01</span> <span class="id" type="var">orbT</span>. <span class="id" type="tactic">split</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">baseP</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="var">base_l</span>; <span class="id" type="tactic">case</span>/<span class="id" type="var">orP</span>: <span class="id" type="var">base_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Re_base</span>; <span class="id" type="tactic">rewrite</span> {2}[<span class="id" type="var">base</span> <span class="id" type="var">l</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_base</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_base</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_base</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_p</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_p</span>.<br/>
*)<br/>
<br/>
<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">base_line_of_something</span> (<span class="id" type="var">a</span> <span class="id" type="var">v</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) <span class="id" type="var">k</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">k</span> != 0 -&gt;<span class="id" type="var">k</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span> -&gt; <span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> (<span class="id" type="var">k</span> * <span class="id" type="var">v</span>) = <span class="id" type="var">base_line_of</span> <span class="id" type="var">a</span> <span class="id" type="var">v</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>; <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [-&gt;|<span class="id" type="var">v_neq0</span>]; <span class="id" type="tactic">rewrite</span> ?<span class="id" type="var">mulr0</span> ?<span class="id" type="var">ReM</span> ?<span class="id" type="var">ImM</span> //=.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">Im_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) -&gt;.<br/>
<span class="id" type="var">have</span>[<span class="id" type="var">Re_k_neq0</span>]: (<span class="id" type="var">Re</span> <span class="id" type="var">k</span> != 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">_</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]) /= <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mul0r</span> <span class="id" type="var">subr0</span> <span class="id" type="var">addr0</span> {3 6 9 12}[<span class="id" type="var">v</span>]<span class="id" type="var">complexE</span> -{3 6}<span class="id" type="var">Re_k</span>{<span class="id" type="var">Re_k</span>}; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Re_v_eq0</span>|<span class="id" type="var">Re_v_neq0</span> /=].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> <span class="id" type="var">v</span> =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_v_eq0</span>|<span class="id" type="var">Im_v_neq0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">v_neq0</span>; <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">v</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">Im_v_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_v_eq0</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> /= !<span class="id" type="var">mulr0</span> !<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">mulf_neq0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulf_neq0</span> ?<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">mulf_neq0</span> //.<br/>
<span class="id" type="tactic">rewrite</span>  -[<span class="id" type="var">Re</span> <span class="id" type="var">k</span> * <span class="id" type="var">Im</span> <span class="id" type="var">v</span>]<span class="id" type="var">divr1</span> -{2}[<span class="id" type="var">Im</span> <span class="id" type="var">v</span>]<span class="id" type="var">divr1</span> !<span class="id" type="var">mulf_div</span> !<span class="id" type="var">mulr1</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrCA</span> -<span class="id" type="var">mulf_div</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">line_of_segment</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="var">line_of</span> <span class="id" type="var">a</span> (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_line_of_segment_1</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">a</span> \<span class="id" type="keyword">in</span> (<span class="id" type="var">line_of_segment</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">line_of_segment</span> -<span class="id" type="var">topredE</span> /= /<span class="id" type="var">is_on_line</span> /=.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> ((<span class="id" type="var">b</span>-<span class="id" type="var">a</span>) =<span class="id" type="var">P</span> 0)) =&gt; [-&gt;|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">dir_of</span> <span class="id" type="var">eqxx</span> /<span class="id" type="var">base_line_of</span> <span class="id" type="var">oner_neq0</span> <span class="id" type="var">eqxx</span> /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> - <span class="id" type="var">_</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">divr1</span> <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_ofP</span> =&gt;/(<span class="id" type="var">_</span> (<span class="id" type="var">b</span> -<span class="id" type="var">a</span>) <span class="id" type="var">dir_neq0</span>) <span class="id" type="var">dir_eq</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">dir_eq</span> =&gt; <span class="id" type="var">k</span> <span class="id" type="var">kP</span> -&gt;.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">kP</span> =&gt;/<span class="id" type="var">andP</span> <span class="id" type="var">kP</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">base_line_of_something</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_line_of_segment_2</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) : <span class="id" type="var">b</span> \<span class="id" type="keyword">in</span> (<span class="id" type="var">line_of_segment</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">line_of_segment</span> -<span class="id" type="var">topredE</span> /= /<span class="id" type="var">is_on_line</span> /=.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> ((<span class="id" type="var">b</span>-<span class="id" type="var">a</span>) =<span class="id" type="var">P</span> 0)) =&gt; [|<span class="id" type="var">dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">eqab</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqab</span>; <span class="id" type="tactic">move</span>: <span class="id" type="var">eqab</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eqab</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">eqab</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subr_eq0</span>; <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eqab</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqab</span> /<span class="id" type="var">dir_of</span> <span class="id" type="var">eqxx</span> /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> <span class="id" type="var">oner_neq0</span> <span class="id" type="var">eqxx</span> /=.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> - <span class="id" type="var">_</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">divr1</span> <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_ofP</span> =&gt;/(<span class="id" type="var">_</span> (<span class="id" type="var">b</span> -<span class="id" type="var">a</span>) <span class="id" type="var">dir_neq0</span>) <span class="id" type="var">dir_eq</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">dir_eq</span> =&gt; <span class="id" type="var">k</span> <span class="id" type="var">kP</span> -&gt;.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">kP</span> =&gt;/<span class="id" type="var">andP</span> <span class="id" type="var">kP</span>; <span class="id" type="tactic">case</span>: <span class="id" type="var">kP</span> =&gt; <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">base_line_of</span> <span class="id" type="var">ReM</span> <span class="id" type="var">ImM</span>. <span class="id" type="tactic">move</span>: <span class="id" type="var">Im_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) -&gt;; <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mul0r</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_real</span> =&gt;/(<span class="id" type="var">_</span> <span class="id" type="var">k</span> <span class="id" type="var">k_real</span>) <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="var">have</span>[<span class="id" type="var">Re_k_neq0</span>]: (<span class="id" type="var">Re</span> <span class="id" type="var">k</span> != 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">_</span> == <span class="id" type="var">_</span>](<span class="id" type="var">fmorph_eq0</span> [<span class="id" type="var">rmorphism</span> <span class="id" type="var">of</span> <span class="id" type="var">real_complex</span> <span class="id" type="var">_</span>]) /= <span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">k_neq0</span> <span class="id" type="var">k_real</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">subr0</span> <span class="id" type="var">addr0</span> {3 6 9 12}[<span class="id" type="var">b</span> - <span class="id" type="var">a</span>]<span class="id" type="var">complexE</span> -{3 6}<span class="id" type="var">Re_k</span>{<span class="id" type="var">Re_k</span>}; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Re</span> (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Re_dir_eq0</span>|<span class="id" type="var">Re_dir_neq0</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">dir_neq0</span>; <span class="id" type="tactic">case</span>: (<span class="id" type="var">altP</span> (<span class="id" type="var">Im</span> (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) =<span class="id" type="var">P</span> 0)) =&gt; [<span class="id" type="var">Im_dir_eq0</span>|<span class="id" type="var">Im_dir_neq0</span> <span class="id" type="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> [<span class="id" type="var">b</span> - <span class="id" type="var">a</span>]<span class="id" type="var">complexE</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">Im_dir_eq0</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Re_dir_eq0</span> <span class="id" type="var">mulr0</span> <span class="id" type="var">eqxx</span> <span class="id" type="var">mulf_neq0</span> //= !<span class="id" type="var">mulr0</span> !<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">mulf_neq0</span> //.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> {1}[<span class="id" type="var">a</span>]<span class="id" type="var">complexE</span> {1}[<span class="id" type="var">b</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_dir_eq0</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">raddfD</span> <span class="id" type="var">raddfN</span> /= =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq_Re_ab</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>: <span class="id" type="var">eq_Re_ab</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subr_eq0</span> =&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq_Re_ab</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq_Re_ab</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">Re_dir_neq0</span>; <span class="id" type="tactic">rewrite</span> /= <span class="id" type="var">mulf_neq0</span> // -[<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> * (<span class="id" type="var">X</span> * <span class="id" type="var">_</span>)]<span class="id" type="var">Re_k</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrA</span> -[<span class="id" type="var">Re</span> <span class="id" type="var">b</span>]<span class="id" type="var">mul1r</span> -<span class="id" type="var">mulf_div</span>; <span class="id" type="var">simpc</span>.<br/>
<span class="id" type="var">have</span>: ((<span class="id" type="var">Re</span> <span class="id" type="var">k</span>)^-1 * (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> / <span class="id" type="var">Re</span> (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>)) * <span class="id" type="var">Re</span> <span class="id" type="var">k</span> = <span class="id" type="var">Re</span> <span class="id" type="var">b</span> / <span class="id" type="var">Re</span> (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrC</span> <span class="id" type="var">mulrA</span> <span class="id" type="var">mulfV</span> // <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="tactic">move</span> -&gt;; <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">complexr0</span> <span class="id" type="var">raddfD</span> <span class="id" type="var">raddfN</span> /= {3}[<span class="id" type="var">a</span>]<span class="id" type="var">complexE</span> {1}[<span class="id" type="var">b</span>]<span class="id" type="var">complexE</span>.<br/>
<span class="id" type="tactic">rewrite</span> {1 2}[<span class="id" type="var">b</span> - <span class="id" type="var">a</span>]<span class="id" type="var">complexE</span>; <span class="id" type="var">simpc</span>; <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">raddfD</span> !<span class="id" type="var">raddfN</span> /=.<br/>
<span class="id" type="var">have</span>: (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">b</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) * (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Re</span> <span class="id" type="var">a</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) * (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mulfVK</span> ?<span class="id" type="var">subrr</span> -?<span class="id" type="var">raddfN</span> -?<span class="id" type="var">raddfD</span>.<br/>
<span class="id" type="var">suff</span>: (<span class="id" type="var">Im</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">b</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) * (<span class="id" type="var">Im</span> <span class="id" type="var">b</span> - <span class="id" type="var">Im</span> <span class="id" type="var">a</span>) ==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Im</span> <span class="id" type="var">a</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) * (<span class="id" type="var">Im</span> <span class="id" type="var">b</span> - <span class="id" type="var">Im</span> <span class="id" type="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span>  <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">Im_eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Im_eq</span>; <span class="id" type="tactic">move</span> -&gt;.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">mulrBr</span> -{2}[<span class="id" type="var">Im</span> <span class="id" type="var">a</span>]<span class="id" type="var">mul1r</span> -{1}[<span class="id" type="var">Im</span> <span class="id" type="var">b</span>]<span class="id" type="var">mul1r</span> !<span class="id" type="var">opprB</span> !<span class="id" type="var">addrA</span> -<span class="id" type="var">subr_eq0</span> <span class="id" type="var">opprB</span>.<br/>
<span class="id" type="tactic">rewrite</span> -<span class="id" type="var">mulrDl</span>; <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">addrA</span> <span class="id" type="var">addrC</span> -!<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> + (<span class="id" type="var">_</span> + <span class="id" type="var">X</span>)]<span class="id" type="var">addrA</span>.<br/>
<span class="id" type="tactic">rewrite</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> + (<span class="id" type="var">_</span> + <span class="id" type="var">X</span>)]<span class="id" type="var">addrC</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> + (<span class="id" type="var">_</span> + <span class="id" type="var">X</span>)]<span class="id" type="var">addrA</span> [<span class="id" type="var">X</span> <span class="id" type="keyword">in</span> <span class="id" type="var">_</span> + (<span class="id" type="var">_</span> + <span class="id" type="var">X</span>)]<span class="id" type="var">addrC</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">addrA</span> <span class="id" type="var">addrC</span> -!<span class="id" type="var">addrA</span> <span class="id" type="var">addrA</span> -<span class="id" type="var">mulrBl</span>.<br/>
<span class="id" type="var">have</span>: (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span> != 0) <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -?<span class="id" type="var">raddfN</span> -?<span class="id" type="var">raddfD</span>.<br/>
<span class="id" type="tactic">move</span>: <span class="id" type="var">Re_dir_neq0</span> =&gt; <span class="id" type="var">_</span> <span class="id" type="var">Re_dir_neq0</span>.<br/>
<span class="id" type="var">have</span>: (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) - (1 + <span class="id" type="var">Re</span> <span class="id" type="var">a</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>)) == 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">subr_eq0</span> -[1]<span class="id" type="var">divr1</span> <span class="id" type="var">addf_div</span> ?<span class="id" type="var">mulr1</span> ?<span class="id" type="var">mul1r</span> // ?<span class="id" type="var">neqr_lt</span> ?<span class="id" type="var">ltr01</span> ?<span class="id" type="var">orbT</span> //.<br/>
&nbsp;&nbsp;<span class="id" type="var">have</span>: (- <span class="id" type="var">Re</span> <span class="id" type="var">a</span> + <span class="id" type="var">Re</span> <span class="id" type="var">a</span> = 0) <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">addrC</span> <span class="id" type="var">subrr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">addrA</span>; <span class="id" type="tactic">move</span>-&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">addr0</span>.<br/>
<span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq</span>{<span class="id" type="var">eq</span>} <span class="id" type="var">mul0r</span> <span class="id" type="var">add0r</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">addrA</span> -<span class="id" type="var">mulrBl</span> -<span class="id" type="var">mulrDl</span>.<br/>
<span class="id" type="var">suff</span>: (1 - <span class="id" type="var">Re</span> <span class="id" type="var">b</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) + <span class="id" type="var">Re</span> <span class="id" type="var">a</span> / (<span class="id" type="var">Re</span> <span class="id" type="var">b</span> - <span class="id" type="var">Re</span> <span class="id" type="var">a</span>) == 0).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt;/<span class="id" type="var">eqP</span> <span class="id" type="var">eq</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eq</span>{<span class="id" type="var">eq</span>} <span class="id" type="var">mul0r</span>.<br/>
<span class="id" type="tactic">rewrite</span> -[1]<span class="id" type="var">divr1</span> <span class="id" type="var">addrAC</span> <span class="id" type="var">addf_div</span> ?<span class="id" type="var">mulr1</span> ?<span class="id" type="var">mul1r</span> // ?<span class="id" type="var">neqr_lt</span> ?<span class="id" type="var">ltr01</span> ?<span class="id" type="var">orbT</span> //.<br/>
<span class="id" type="var">have</span>: (- <span class="id" type="var">Re</span> <span class="id" type="var">a</span> + <span class="id" type="var">Re</span> <span class="id" type="var">a</span> = 0) <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">addrC</span> <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> -<span class="id" type="var">addrA</span>; <span class="id" type="tactic">move</span>-&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">addr0</span> <span class="id" type="var">subrr</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">pbisect</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) := <span class="id" type="var">line_of</span> ((<span class="id" type="var">a</span> + <span class="id" type="var">b</span>) / 2%:<span class="id" type="var">R</span>) ('<span class="id" type="var">i</span> * (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">collinear</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">is_on_line_collinear</span> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]) (<span class="id" type="var">l</span> : <span class="id" type="var">line</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_on_line</span> <span class="id" type="var">a</span> <span class="id" type="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_on_line</span> <span class="id" type="var">b</span> <span class="id" type="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_on_line</span> <span class="id" type="var">c</span> <span class="id" type="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">collinear</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pbisect_eq</span> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">p</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>]),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_on_line</span> <span class="id" type="var">p</span> (<span class="id" type="var">pbisect</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) &lt;-&gt; <span class="id" type="var">cong</span> <span class="id" type="var">p</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span> <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">intersection</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span> : <span class="id" type="var">line</span>) :=<br/>
<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">intersectionC</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> : <span class="id" type="var">intersection</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> = <span class="id" type="var">intersection</span> <span class="id" type="var">l2</span> <span class="id" type="var">l1</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">mem_intersection</span> : <span class="id" type="keyword">forall</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span> : <span class="id" type="var">line</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">is_on_line</span> <span class="id" type="var">l1</span> (<span class="id" type="var">intersection</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_xxa</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span> : <span class="id" type="var">between</span> <span class="id" type="var">x</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEacb</span> <span class="id" type="var">eqxx</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_axx</span> <span class="id" type="var">a</span> <span class="id" type="var">x</span> : <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">x</span> <span class="id" type="var">x</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEcab</span> <span class="id" type="var">eqxx</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_identity</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span> -&gt; <span class="id" type="var">a</span> = <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span>; <span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ba</span>] //= := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">ler10</span> // <span class="id" type="var">subr_eq0</span> <span class="id" type="var">eq_sym</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">cong_pseudo_reflexivity</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span> <span class="id" type="var">distrC</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">cong_identity</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">c</span> -&gt; <span class="id" type="var">a</span> = <span class="id" type="var">b</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span> <span class="id" type="var">subrr</span> <span class="id" type="var">normr0</span> <span class="id" type="var">normr_eq0</span> <span class="id" type="var">subr_eq0</span> <span class="id" type="var">eq_sym</span> =&gt; /<span class="id" type="var">eqP</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">cong_inner_transitivity</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">e</span> <span class="id" type="var">f</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> -&gt; <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">e</span> <span class="id" type="var">f</span> -&gt; <span class="id" type="var">cong</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">e</span> <span class="id" type="var">f</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span> =&gt; /<span class="id" type="var">eqP</span> -&gt; /<span class="id" type="var">eqP</span> -&gt;. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">betweenP</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> (<span class="id" type="var">s</span> := [:: <span class="id" type="var">a</span>; <span class="id" type="var">b</span>;<span class="id" type="var">c</span>]) : <br/>
&nbsp;&nbsp;<span class="id" type="var">reflect</span> (<span class="id" type="var">exists2</span> <span class="id" type="var">x</span>, `|<span class="id" type="var">x</span>| = 1 &amp; <span class="id" type="keyword">let</span> <span class="id" type="var">sx</span> := [<span class="id" type="var">seq</span> <span class="id" type="var">y</span> * <span class="id" type="var">x</span> | <span class="id" type="var">y</span> &lt;- <span class="id" type="var">s</span>] <span class="id" type="keyword">in</span> <span class="id" type="var">all</span> [<span class="id" type="var">pred</span> <span class="id" type="var">y</span> | <span class="id" type="var">y</span> \<span class="id" type="var">is</span> <span class="id" type="var">Num.real</span>] <span class="id" type="var">sx</span> &amp;&amp; (<span class="id" type="var">sorted</span> &lt;=%<span class="id" type="var">R</span> <span class="id" type="var">sx</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> /=.<br/>
<span class="id" type="keyword">Abort</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">between_trans</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> -&gt; <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">betweenEabc</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ad</span> /=] //= := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>; <span class="id" type="tactic">rewrite</span> ?(<span class="id" type="var">orbT</span>, <span class="id" type="var">orbF</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; /<span class="id" type="var">eqP</span> -&gt;; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqxx</span> /= <span class="id" type="var">orbF</span>.<br/>
<span class="id" type="var">have</span> [-&gt; <span class="id" type="var">_</span>|<span class="id" type="var">neq_bd</span>] //= := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>; <span class="id" type="tactic">rewrite</span> ?(<span class="id" type="var">orbT</span>, <span class="id" type="var">orbF</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">move</span>=&gt; /<span class="id" type="var">eqP</span> &lt;-; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">subr_eq0</span> ?<span class="id" type="var">ler01</span> ?<span class="id" type="var">lerr</span> // <span class="id" type="var">eq_sym</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; /<span class="id" type="var">andP</span> [<span class="id" type="var">b_ge0</span> <span class="id" type="var">b_le1</span>] /<span class="id" type="var">andP</span> [<span class="id" type="var">c_ge0</span> <span class="id" type="var">c_le1</span>].<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">c</span>](<span class="id" type="var">addrNK</span> <span class="id" type="var">b</span>) -<span class="id" type="var">addrA</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrDl</span>.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">c</span> - <span class="id" type="var">b</span>](@<span class="id" type="var">mulfVK</span> <span class="id" type="var">_</span> (<span class="id" type="var">d</span> - <span class="id" type="var">b</span>)) ?<span class="id" type="var">subr_eq0</span> 1?<span class="id" type="var">eq_sym</span> //.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <span class="id" type="var">X</span> <span class="id" type="keyword">in</span> 0 &lt;= <span class="id" type="var">_</span> + <span class="id" type="var">X</span> &lt;= <span class="id" type="var">_</span>](<span class="id" type="var">addrNK</span> <span class="id" type="var">d</span>) -<span class="id" type="var">addrA</span>.<br/>
<span class="id" type="tactic">rewrite</span> [<span class="id" type="keyword">in</span> <span class="id" type="var">X</span> <span class="id" type="keyword">in</span> 0 &lt;= <span class="id" type="var">_</span> + <span class="id" type="var">X</span> &lt;= <span class="id" type="var">_</span>]<span class="id" type="var">mulrDl</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">subr_eq0</span> 1?<span class="id" type="var">eq_sym</span> //.<br/>
<span class="id" type="tactic">rewrite</span> -[<span class="id" type="var">b</span> - <span class="id" type="var">d</span>]<span class="id" type="var">opprB</span> <span class="id" type="var">mulNr</span> -<span class="id" type="var">mulN1r</span> <span class="id" type="var">addrA</span> <span class="id" type="var">mulrA</span> -!<span class="id" type="var">mulrDl</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">inner_pasch</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span> <span class="id" type="var">c</span> -&gt; <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">q</span> <span class="id" type="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">x</span>, <span class="id" type="var">between</span> <span class="id" type="var">p</span> <span class="id" type="var">x</span> <span class="id" type="var">b</span> /\ <span class="id" type="var">between</span> <span class="id" type="var">q</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_pb</span>] := <span class="id" type="var">eqVneq</span> <span class="id" type="var">p</span> <span class="id" type="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">abc</span> <span class="id" type="var">bqc</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">b</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">between_xxa</span> <span class="id" type="var">between_sym</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">admit</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEacb</span>; <span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ap</span> /= <span class="id" type="var">acap</span>] := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">exists</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">between_xxa</span> <span class="id" type="var">between_axx</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEacb</span>; <span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_bq</span> /= <span class="id" type="var">bcbq</span>] := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">exists</span> <span class="id" type="var">q</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">between_xxa</span> <span class="id" type="var">between_axx</span>.<br/>

<br/>
<span class="id" type="tactic">set</span> <span class="id" type="var">ap'</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>] := (<span class="id" type="var">p</span> - <span class="id" type="var">a</span>) / (<span class="id" type="var">q</span> - <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">set</span> <span class="id" type="var">ab'</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>] := (<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) / (<span class="id" type="var">q</span> - <span class="id" type="var">a</span>).<br/>
<span class="id" type="tactic">set</span> <span class="id" type="var">pb'</span> : <span class="id" type="var">R</span>[<span class="id" type="var">i</span>] := (<span class="id" type="var">b</span> - <span class="id" type="var">p</span>) / (<span class="id" type="var">q</span> - <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="tactic">exists</span> (((<span class="id" type="var">Re</span> <span class="id" type="var">pb'</span> / <span class="id" type="var">Im</span> <span class="id" type="var">pb'</span> * <span class="id" type="var">Im</span> <span class="id" type="var">ap'</span>)*<span class="id" type="var">i</span> + <span class="id" type="var">a</span>) * (<span class="id" type="var">q</span> - <span class="id" type="var">a</span>)).<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">betweenEabc</span>.<br/>

<br/>

<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">euclid</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : ~ (<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">cc</span>, <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">cc</span> <span class="id" type="var">b</span> <span class="id" type="var">cc</span> /\ <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">cc</span> <span class="id" type="var">c</span> <span class="id" type="var">cc</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span> =&gt; <span class="id" type="var">nonalign_abc</span>.<br/>
<span class="id" type="tactic">exists</span> ((<span class="id" type="var">a</span> + <span class="id" type="var">b</span> + <span class="id" type="var">c</span>) / 3%:<span class="id" type="var">R</span>).<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">congD</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>  <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> :<br/>
&nbsp;&nbsp;<span class="id" type="var">cong</span> (<span class="id" type="var">a</span> + <span class="id" type="var">x</span>) (<span class="id" type="var">b</span> + <span class="id" type="var">x</span>) (<span class="id" type="var">c</span> + <span class="id" type="var">y</span>) (<span class="id" type="var">d</span> + <span class="id" type="var">y</span>) = <span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span>; <span class="id" type="tactic">do</span> !<span class="id" type="tactic">rewrite</span> <span class="id" type="var">opprD</span> <span class="id" type="var">addrACA</span> <span class="id" type="var">subrr</span> <span class="id" type="var">addr0</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">five_segments</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span> <span class="id" type="var">c</span> <span class="id" type="var">c'</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">b'</span> <span class="id" type="var">c'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">d</span> <span class="id" type="var">a'</span> <span class="id" type="var">d'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> <span class="id" type="var">b'</span> <span class="id" type="var">d'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> -&gt; <span class="id" type="var">between</span> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <span class="id" type="var">c'</span> -&gt; <span class="id" type="var">a</span> &lt;&gt; <span class="id" type="var">b</span> -&gt; <span class="id" type="var">cong</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">c'</span> <span class="id" type="var">d'</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">segment_construction</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">exists</span> <span class="id" type="var">e</span>, <span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">e</span> /\ <span class="id" type="var">cong</span> <span class="id" type="var">b</span> <span class="id" type="var">e</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ba</span>] := <span class="id" type="var">eqVneq</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exists</span> ((<span class="id" type="var">c</span> - <span class="id" type="var">d</span>) + <span class="id" type="var">a</span>); <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span> /<span class="id" type="var">cong</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">subrr</span> <span class="id" type="var">mul0r</span> <span class="id" type="var">addrK</span> <span class="id" type="var">distrC</span> <span class="id" type="var">lerr</span> <span class="id" type="var">orbT</span>; <span class="id" type="tactic">split</span>.<br/>
<span class="id" type="tactic">exists</span> ((<span class="id" type="var">b</span> - <span class="id" type="var">a</span>) / `|<span class="id" type="var">b</span> - <span class="id" type="var">a</span>| * `|<span class="id" type="var">d</span> - <span class="id" type="var">c</span>| + <span class="id" type="var">b</span>); <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span> /<span class="id" type="var">cong</span>.<br/>
<span class="id" type="tactic">rewrite</span> !<span class="id" type="var">addrK</span> !<span class="id" type="var">invfM</span> !<span class="id" type="var">mulrA</span> -[<span class="id" type="var">a</span> - <span class="id" type="var">b</span>]<span class="id" type="var">opprB</span> !<span class="id" type="var">mulNr</span> <span class="id" type="var">oppr_le0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">subr_eq0</span> ?<span class="id" type="var">mul1r</span> // <span class="id" type="var">mulr_ge0</span> ?<span class="id" type="var">invr_ge0</span> // <span class="id" type="var">orbT</span>; <span class="id" type="tactic">split</span> =&gt; //.<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">normrM</span> <span class="id" type="var">normfV</span> !<span class="id" type="var">normr_id</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">mul1r</span> ?<span class="id" type="var">normr_eq0</span> ?<span class="id" type="var">subr_eq0</span> ?<span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">lower_dim</span> : <span class="id" type="tactic">exists</span> <span class="id" type="var">a</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">b</span>, <span class="id" type="tactic">exists</span> <span class="id" type="var">c</span>,<br/>
&nbsp;&nbsp;~ (<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">exists</span> 0, 1, '<span class="id" type="var">i</span>; <span class="id" type="tactic">rewrite</span> /<span class="id" type="var">between</span> !<span class="id" type="var">eq_complex</span> [0 == 1]<span class="id" type="var">eq_sym</span> !<span class="id" type="var">oner_eq0</span> //=.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">andbF</span> !<span class="id" type="var">sub0r</span> !<span class="id" type="var">subr0</span> /= <span class="id" type="var">mulN1r</span> <span class="id" type="var">invrN</span> <span class="id" type="var">mulrN</span> <span class="id" type="var">divr1</span> !<span class="id" type="var">oppr_le0</span>.<br/>
<span class="id" type="tactic">rewrite</span> <span class="id" type="var">mulrBl</span> <span class="id" type="var">divff</span> ?<span class="id" type="var">eq_complex</span> /= ?<span class="id" type="var">eqxx</span> ?<span class="id" type="var">oner_eq0</span> // <span class="id" type="var">mul1r</span>.<br/>
<span class="id" type="tactic">rewrite</span> !(<span class="id" type="var">invr_ge0</span>, <span class="id" type="var">subr_ge0</span>).<br/>
<span class="id" type="tactic">by</span> <span class="id" type="tactic">rewrite</span> !<span class="id" type="var">lecE</span> /= <span class="id" type="var">mul0r</span> [0 == 1]<span class="id" type="var">eq_sym</span> <span class="id" type="var">oner_eq0</span> <span class="id" type="var">ler10</span> !<span class="id" type="var">andbF</span> /=; <span class="id" type="tactic">do</span> !<span class="id" type="tactic">case</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">upper_dim</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> :  <span class="id" type="var">p</span> &lt;&gt; <span class="id" type="var">q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cong</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span> <span class="id" type="var">a</span> <span class="id" type="var">q</span> -&gt; <span class="id" type="var">cong</span> <span class="id" type="var">b</span> <span class="id" type="var">p</span> <span class="id" type="var">b</span> <span class="id" type="var">q</span> -&gt; <span class="id" type="var">cong</span> <span class="id" type="var">c</span> <span class="id" type="var">p</span> <span class="id" type="var">c</span> <span class="id" type="var">q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">between</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> \/ <span class="id" type="var">between</span> <span class="id" type="var">c</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
<span class="id" type="tactic">move</span>=&gt; <span class="id" type="var">neq_pq</span>; <span class="id" type="var">have</span> {<span class="id" type="var">neq_pq</span>} <span class="id" type="var">neq_pq</span> : <span class="id" type="var">p</span> != <span class="id" type="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span>/<span class="id" type="var">negP</span> =&gt; /<span class="id" type="var">eqP</span> <span class="id" type="var">eq_pq</span>; <span class="id" type="tactic">apply</span>: <span class="id" type="var">neq_pq</span>.<br/>
<span class="id" type="tactic">rewrite</span> /<span class="id" type="var">cong</span> /<span class="id" type="var">between</span> =&gt; <span class="id" type="var">pa_qa</span> <span class="id" type="var">pb_qb</span> <span class="id" type="var">pc_qc</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_bc</span>] := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">left</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ca</span>] := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">left</span>.<br/>
<span class="id" type="var">have</span> [-&gt;|<span class="id" type="var">neq_ab</span>] /= := <span class="id" type="var">altP</span> <span class="id" type="var">eqP</span>; <span class="id" type="tactic">first</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">right</span>; <span class="id" type="tactic">right</span>.<br/>
<span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">tarskiModel</span> := <span class="id" type="var">Build_Tarski</span> <br/>
&nbsp;&nbsp;<span class="id" type="var">between_identity</span> <span class="id" type="var">cong_pseudo_reflexivity</span> <span class="id" type="var">cong_identity</span><br/>
&nbsp;&nbsp;<span class="id" type="var">cong_inner_transitivity</span> <span class="id" type="var">inner_pasch</span> <span class="id" type="var">euclid</span> <span class="id" type="var">five_segments</span><br/>
&nbsp;&nbsp;<span class="id" type="var">segment_construction</span> <span class="id" type="var">lower_dim</span> <span class="id" type="var">upper_dim</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">RcfTarski</span>.<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">RcfTarski</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>